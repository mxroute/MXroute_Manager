define(["lodash","angular","cjt/util/locale","uiBootstrap","cjt/directives/actionButtonDirective","cjt/directives/loadingPanel","cjt/directives/toggleSortDirective","cjt/directives/searchDirective","cjt/directives/pageSizeDirective","cjt/filters/startFromFilter","cjt/decorators/paginationDecorator"],function(_,angular,LOCALE){var app;try{app=angular.module("cpanel.jetbackup")}catch(e){app=angular.module("cpanel.jetbackup",[])}app.controller("settings",["$rootScope","$scope","$interval","$timeout","jetapi","growl","$window",function($rootScope,$scope,$interval,$timeout,jetapi,growl,$window){var COMPONENT_NAME="SettingsTable";$scope.saveChangesStatus=undefined;$scope.settings={};$scope.clearStatus=function(){$scope.saveChangesStatus=undefined};$scope.saveChanges=function(){var formOrder=["email"];if($scope.settingsForm.$invalid){$scope.settingsForm.$setSubmitted();var focused=false;angular.forEach(formOrder,function(name){if($scope.settingsForm[name]&&$scope.settingsForm[name].$invalid){$scope.settingsForm[name].$setDirty();if(!focused){angular.element("[name='settingsForm'] [name='"+name+"']").focus();focused=true}}});return}var apiParams={email:$scope.settings.email};$scope.savingChanges=true;$scope.saveChangesStatus=undefined;return jetapi.manageAccount(apiParams).then(function(data){$scope.savingChanges=false;$scope.saveChangesStatus={message:LOCALE.maketext("Settings saved successfully"),type:"success",closeable:true,ttl:1e4};$scope.settingsForm.$setPristine();$scope.settingsForm.$setUntouched()},function(error){$scope.saveChangesStatus={message:error,type:"danger",closeable:true,ttl:1e4};$scope.savingChanges=false})};$scope.fetch=function(){return jetapi.getAccountDetails().then(function(response){$scope.settings=response.data},function(error){$scope.saveChangesStatus={message:error,type:"danger",closeable:true,ttl:1e4}})};$timeout($scope.fetch)}])});