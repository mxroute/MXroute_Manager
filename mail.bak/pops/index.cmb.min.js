!function(e){define("jquery-chosen",["jquery"],function(){return function(){(function(){var e,t,s,i,n,o={}.hasOwnProperty,a=function(e,t){function s(){this.constructor=e}for(var i in t)o.call(t,i)&&(e[i]=t[i]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e};i=function(){function e(){this.options_index=0,this.parsed=[]}return e.prototype.add_node=function(e){return"OPTGROUP"===e.nodeName.toUpperCase()?this.add_group(e):this.add_option(e)},e.prototype.add_group=function(e){var t,s,i,n,o,a;for(t=this.parsed.length,this.parsed.push({array_index:t,group:!0,label:this.escapeExpression(e.label),title:e.title?e.title:void 0,children:0,disabled:e.disabled,classes:e.className}),o=e.childNodes,a=[],i=0,n=o.length;n>i;i++)s=o[i],a.push(this.add_option(s,t,e.disabled));return a},e.prototype.add_option=function(e,t,s){return"OPTION"===e.nodeName.toUpperCase()?(""!==e.text?(null!=t&&(this.parsed[t].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:e.value,text:e.text,html:e.innerHTML,title:e.title?e.title:void 0,selected:e.selected,disabled:s===!0?s:e.disabled,group_array_index:t,group_label:null!=t?this.parsed[t].label:null,classes:e.className,style:e.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},e.prototype.escapeExpression=function(e){var t,s;return null==e||e===!1?"":/[\&\<\>\"\'\`]/.test(e)?(t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},s=/&(?!\w+;)|[\<\>\"\'\`]/g,e.replace(s,function(e){return t[e]||"&amp;"})):e},e}(),i.select_to_array=function(e){var t,s,n,o,a;for(s=new i,a=e.childNodes,n=0,o=a.length;o>n;n++)t=a[n],s.add_node(t);return s.parsed},t=function(){function e(t,s){this.form_field=t,this.options=null!=s?s:{},e.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers(),this.on_ready())}return e.prototype.set_default_values=function(){var e=this;return this.click_test_action=function(t){return e.test_active_click(t)},this.activate_action=function(t){return e.activate_field(t)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null!=this.options.enable_split_word_search?this.options.enable_split_word_search:!0,this.group_search=null!=this.options.group_search?this.options.group_search:!0,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=null!=this.options.single_backstroke_delete?this.options.single_backstroke_delete:!0,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.display_selected_options=null!=this.options.display_selected_options?this.options.display_selected_options:!0,this.display_disabled_options=null!=this.options.display_disabled_options?this.options.display_disabled_options:!0,this.include_group_label_in_selected=this.options.include_group_label_in_selected||!1,this.max_shown_results=this.options.max_shown_results||Number.POSITIVE_INFINITY},e.prototype.set_default_text=function(){return this.default_text=this.form_field.getAttribute("data-placeholder")?this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||e.default_multiple_text:this.options.placeholder_text_single||this.options.placeholder_text||e.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||e.default_no_result_text},e.prototype.choice_label=function(e){return this.include_group_label_in_selected&&null!=e.group_label?"<b class='group-name'>"+e.group_label+"</b>"+e.html:e.html},e.prototype.mouse_enter=function(){return this.mouse_on_container=!0},e.prototype.mouse_leave=function(){return this.mouse_on_container=!1},e.prototype.input_focus=function(){var e=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return e.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},e.prototype.input_blur=function(){var e=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return e.blur_test()},100))},e.prototype.results_option_build=function(e){var t,s,i,n,o,a,r;for(t="",n=0,r=this.results_data,o=0,a=r.length;a>o&&(s=r[o],i="",i=s.group?this.result_add_group(s):this.result_add_option(s),""!==i&&(n++,t+=i),(null!=e?e.first:void 0)&&(s.selected&&this.is_multiple?this.choice_build(s):s.selected&&!this.is_multiple&&this.single_set_selected_text(this.choice_label(s))),!(n>=this.max_shown_results));o++);return t},e.prototype.result_add_option=function(e){var t,s;return e.search_match&&this.include_option_in_results(e)?(t=[],e.disabled||e.selected&&this.is_multiple||t.push("active-result"),!e.disabled||e.selected&&this.is_multiple||t.push("disabled-result"),e.selected&&t.push("result-selected"),null!=e.group_array_index&&t.push("group-option"),""!==e.classes&&t.push(e.classes),s=document.createElement("li"),s.className=t.join(" "),s.style.cssText=e.style,s.setAttribute("data-option-array-index",e.array_index),s.innerHTML=e.search_text,e.title&&(s.title=e.title),this.outerHTML(s)):""},e.prototype.result_add_group=function(e){var t,s;return(e.search_match||e.group_match)&&e.active_options>0?(t=[],t.push("group-result"),e.classes&&t.push(e.classes),s=document.createElement("li"),s.className=t.join(" "),s.innerHTML=e.search_text,e.title&&(s.title=e.title),this.outerHTML(s)):""},e.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.results_build(),this.results_showing?this.winnow_results():void 0},e.prototype.reset_single_select_options=function(){var e,t,s,i,n;for(i=this.results_data,n=[],t=0,s=i.length;s>t;t++)e=i[t],n.push(e.selected?e.selected=!1:void 0);return n},e.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},e.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()},e.prototype.winnow_results=function(){var e,t,s,i,n,o,a,r,l,c,u,d;for(this.no_results_clear(),i=0,o=this.get_search_text(),e=o.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),l=new RegExp(e,"i"),s=this.get_search_regex(e),d=this.results_data,c=0,u=d.length;u>c;c++)t=d[c],t.search_match=!1,n=null,this.include_option_in_results(t)&&(t.group&&(t.group_match=!1,t.active_options=0),null!=t.group_array_index&&this.results_data[t.group_array_index]&&(n=this.results_data[t.group_array_index],0===n.active_options&&n.search_match&&(i+=1),n.active_options+=1),t.search_text=t.group?t.label:t.html,(!t.group||this.group_search)&&(t.search_match=this.search_string_match(t.search_text,s),t.search_match&&!t.group&&(i+=1),t.search_match?(o.length&&(a=t.search_text.search(l),r=t.search_text.substr(0,a+o.length)+"</em>"+t.search_text.substr(a+o.length),t.search_text=r.substr(0,a)+"<em>"+r.substr(a)),null!=n&&(n.group_match=!0)):null!=t.group_array_index&&this.results_data[t.group_array_index].search_match&&(t.search_match=!0)));return this.result_clear_highlight(),1>i&&o.length?(this.update_results_content(""),this.no_results(o)):(this.update_results_content(this.results_option_build()),this.winnow_results_set_highlight())},e.prototype.get_search_regex=function(e){var t;return t=this.search_contains?"":"^",new RegExp(t+e,"i")},e.prototype.search_string_match=function(e,t){var s,i,n,o;if(t.test(e))return!0;if(this.enable_split_word_search&&(e.indexOf(" ")>=0||0===e.indexOf("["))&&(i=e.replace(/\[|\]/g,"").split(" "),i.length))for(n=0,o=i.length;o>n;n++)if(s=i[n],t.test(s))return!0},e.prototype.choices_count=function(){var e,t,s,i;if(null!=this.selected_option_count)return this.selected_option_count;for(this.selected_option_count=0,i=this.form_field.options,t=0,s=i.length;s>t;t++)e=i[t],e.selected&&(this.selected_option_count+=1);return this.selected_option_count},e.prototype.choices_click=function(e){return e.preventDefault(),this.results_showing||this.is_disabled?void 0:this.results_show()},e.prototype.keyup_checker=function(e){var t,s;switch(t=null!=(s=e.which)?s:e.keyCode,this.search_field_scale(),t){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(e.preventDefault(),this.results_showing)return this.result_select(e);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:case 18:break;default:return this.results_search()}},e.prototype.clipboard_event_checker=function(){var e=this;return setTimeout(function(){return e.results_search()},50)},e.prototype.container_width=function(){return null!=this.options.width?this.options.width:""+this.form_field.offsetWidth+"px"},e.prototype.include_option_in_results=function(e){return this.is_multiple&&!this.display_selected_options&&e.selected?!1:!this.display_disabled_options&&e.disabled?!1:e.empty?!1:!0},e.prototype.search_results_touchstart=function(e){return this.touch_started=!0,this.search_results_mouseover(e)},e.prototype.search_results_touchmove=function(e){return this.touch_started=!1,this.search_results_mouseout(e)},e.prototype.search_results_touchend=function(e){return this.touch_started?this.search_results_mouseup(e):void 0},e.prototype.outerHTML=function(e){var t;return e.outerHTML?e.outerHTML:(t=document.createElement("div"),t.appendChild(e),t.innerHTML)},e.browser_is_supported=function(){return/iP(od|hone)/i.test(window.navigator.userAgent)?!1:/Android/i.test(window.navigator.userAgent)&&/Mobile/i.test(window.navigator.userAgent)?!1:/IEMobile/i.test(window.navigator.userAgent)?!1:/Windows Phone/i.test(window.navigator.userAgent)?!1:/BlackBerry/i.test(window.navigator.userAgent)?!1:/BB10/i.test(window.navigator.userAgent)?!1:"Microsoft Internet Explorer"===window.navigator.appName?document.documentMode>=8:!0},e.default_multiple_text="Select Some Options",e.default_single_text="Select an Option",e.default_no_result_text="No results match",e}(),e=jQuery,e.fn.extend({chosen:function(i){return t.browser_is_supported()?this.each(function(){var t,n;return t=e(this),n=t.data("chosen"),"destroy"===i?void(n instanceof s&&n.destroy()):void(n instanceof s||t.data("chosen",new s(this,i)))}):this}}),s=function(t){function s(){return n=s.__super__.constructor.apply(this,arguments)}return a(s,t),s.prototype.setup=function(){return this.form_field_jq=e(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field_jq.hasClass("chosen-rtl")},s.prototype.set_up_html=function(){var t,s;return t=["chosen-container"],t.push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&t.push(this.form_field.className),this.is_rtl&&t.push("chosen-rtl"),s={"class":t.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.form_field.id.length&&(s.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=e("<div />",s),this.container.html(this.is_multiple?'<ul class="chosen-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>':'<a class="chosen-single chosen-default"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>'),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chosen-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chosen-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chosen-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chosen-search").first(),this.selected_item=this.container.find(".chosen-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior()},s.prototype.on_ready=function(){return this.form_field_jq.trigger("chosen:ready",{chosen:this})},s.prototype.register_observers=function(){var e=this;return this.container.bind("touchstart.chosen",function(t){return e.container_mousedown(t),t.preventDefault()}),this.container.bind("touchend.chosen",function(t){return e.container_mouseup(t),t.preventDefault()}),this.container.bind("mousedown.chosen",function(t){e.container_mousedown(t)}),this.container.bind("mouseup.chosen",function(t){e.container_mouseup(t)}),this.container.bind("mouseenter.chosen",function(t){e.mouse_enter(t)}),this.container.bind("mouseleave.chosen",function(t){e.mouse_leave(t)}),this.search_results.bind("mouseup.chosen",function(t){e.search_results_mouseup(t)}),this.search_results.bind("mouseover.chosen",function(t){e.search_results_mouseover(t)}),this.search_results.bind("mouseout.chosen",function(t){e.search_results_mouseout(t)}),this.search_results.bind("mousewheel.chosen DOMMouseScroll.chosen",function(t){e.search_results_mousewheel(t)}),this.search_results.bind("touchstart.chosen",function(t){e.search_results_touchstart(t)}),this.search_results.bind("touchmove.chosen",function(t){e.search_results_touchmove(t)}),this.search_results.bind("touchend.chosen",function(t){e.search_results_touchend(t)}),this.form_field_jq.bind("chosen:updated.chosen",function(t){e.results_update_field(t)}),this.form_field_jq.bind("chosen:activate.chosen",function(t){e.activate_field(t)}),this.form_field_jq.bind("chosen:open.chosen",function(t){e.container_mousedown(t)}),this.form_field_jq.bind("chosen:close.chosen",function(t){e.input_blur(t)}),this.search_field.bind("blur.chosen",function(t){e.input_blur(t)}),this.search_field.bind("keyup.chosen",function(t){e.keyup_checker(t)}),this.search_field.bind("keydown.chosen",function(t){e.keydown_checker(t)}),this.search_field.bind("focus.chosen",function(t){e.input_focus(t)}),this.search_field.bind("cut.chosen",function(t){e.clipboard_event_checker(t)}),this.search_field.bind("paste.chosen",function(t){e.clipboard_event_checker(t)}),this.is_multiple?this.search_choices.bind("click.chosen",function(t){e.choices_click(t)}):this.container.bind("click.chosen",function(e){e.preventDefault()})},s.prototype.destroy=function(){return e(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action),this.search_field[0].tabIndex&&(this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex),this.container.remove(),this.form_field_jq.removeData("chosen"),this.form_field_jq.show()},s.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chosen-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus.chosen",this.activate_action),this.close_field()):(this.container.removeClass("chosen-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus.chosen",this.activate_action))},s.prototype.container_mousedown=function(t){return this.is_disabled||(t&&"mousedown"===t.type&&!this.results_showing&&t.preventDefault(),null!=t&&e(t.target).hasClass("search-choice-close"))?void 0:(this.active_field?this.is_multiple||!t||e(t.target)[0]!==this.selected_item[0]&&!e(t.target).parents("a.chosen-single").length||(t.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),e(this.container[0].ownerDocument).bind("click.chosen",this.click_test_action),this.results_show()),this.activate_field())},s.prototype.container_mouseup=function(e){return"ABBR"!==e.target.nodeName||this.is_disabled?void 0:this.results_reset(e)},s.prototype.search_results_mousewheel=function(e){var t;return e.originalEvent&&(t=e.originalEvent.deltaY||-e.originalEvent.wheelDelta||e.originalEvent.detail),null!=t?(e.preventDefault(),"DOMMouseScroll"===e.type&&(t=40*t),this.search_results.scrollTop(t+this.search_results.scrollTop())):void 0},s.prototype.blur_test=function(){return!this.active_field&&this.container.hasClass("chosen-container-active")?this.close_field():void 0},s.prototype.close_field=function(){return e(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chosen-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},s.prototype.activate_field=function(){return this.container.addClass("chosen-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},s.prototype.test_active_click=function(t){var s;return s=e(t.target).closest(".chosen-container"),s.length&&this.container[0]===s[0]?this.active_field=!0:this.close_field()},s.prototype.results_build=function(){return this.parsing=!0,this.selected_option_count=null,this.results_data=i.select_to_array(this.form_field),this.is_multiple?this.search_choices.find("li.search-choice").remove():this.is_multiple||(this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field[0].readOnly=!0,this.container.addClass("chosen-container-single-nosearch")):(this.search_field[0].readOnly=!1,this.container.removeClass("chosen-container-single-nosearch"))),this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1},s.prototype.result_do_highlight=function(e){var t,s,i,n,o;if(e.length){if(this.result_clear_highlight(),this.result_highlight=e,this.result_highlight.addClass("highlighted"),i=parseInt(this.search_results.css("maxHeight"),10),o=this.search_results.scrollTop(),n=i+o,s=this.result_highlight.position().top+this.search_results.scrollTop(),t=s+this.result_highlight.outerHeight(),t>=n)return this.search_results.scrollTop(t-i>0?t-i:0);if(o>s)return this.search_results.scrollTop(s)}},s.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},s.prototype.results_show=function(){return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.container.addClass("chosen-with-drop"),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results(),this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this}))},s.prototype.update_results_content=function(e){return this.search_results.html(e)},s.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),this.container.removeClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})),this.results_showing=!1},s.prototype.set_tab_index=function(){var e;return this.form_field.tabIndex?(e=this.form_field.tabIndex,this.form_field.tabIndex=-1,this.search_field[0].tabIndex=e):void 0},s.prototype.set_label_behavior=function(){var t=this;return this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=e("label[for='"+this.form_field.id+"']")),this.form_field_label.length>0?this.form_field_label.bind("click.chosen",function(e){return t.is_multiple?t.container_mousedown(e):t.activate_field()}):void 0},s.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},s.prototype.search_results_mouseup=function(t){var s;return s=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),s.length?(this.result_highlight=s,this.result_select(t),this.search_field.focus()):void 0},s.prototype.search_results_mouseover=function(t){var s;return s=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),s?this.result_do_highlight(s):void 0},s.prototype.search_results_mouseout=function(t){return e(t.target).hasClass("active-result")?this.result_clear_highlight():void 0},s.prototype.choice_build=function(t){var s,i,n=this;return s=e("<li />",{"class":"search-choice"}).html("<span>"+this.choice_label(t)+"</span>"),t.disabled?s.addClass("search-choice-disabled"):(i=e("<a />",{"class":"search-choice-close","data-option-array-index":t.array_index}),i.bind("click.chosen",function(e){return n.choice_destroy_link_click(e)}),s.append(i)),this.search_container.before(s)},s.prototype.choice_destroy_link_click=function(t){return t.preventDefault(),t.stopPropagation(),this.is_disabled?void 0:this.choice_destroy(e(t.target))},s.prototype.choice_destroy=function(e){return this.result_deselect(e[0].getAttribute("data-option-array-index"))?(this.show_search_field_default(),this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1&&this.results_hide(),e.parents("li").first().remove(),this.search_field_scale()):void 0},s.prototype.results_reset=function(){return this.reset_single_select_options(),this.form_field.options[0].selected=!0,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},s.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},s.prototype.result_select=function(e){var t,s;return this.result_highlight?(t=this.result_highlight,this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.is_multiple?t.removeClass("active-result"):this.reset_single_select_options(),t.addClass("result-selected"),s=this.results_data[t[0].getAttribute("data-option-array-index")],s.selected=!0,this.form_field.options[s.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(s):this.single_set_selected_text(this.choice_label(s)),(e.metaKey||e.ctrlKey)&&this.is_multiple||this.results_hide(),this.show_search_field_default(),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[s.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,e.preventDefault(),this.search_field_scale())):void 0},s.prototype.single_set_selected_text=function(e){return null==e&&(e=this.default_text),e===this.default_text?this.selected_item.addClass("chosen-default"):(this.single_deselect_control_build(),this.selected_item.removeClass("chosen-default")),this.selected_item.find("span").html(e)},s.prototype.result_deselect=function(e){var t;return t=this.results_data[e],this.form_field.options[t.options_index].disabled?!1:(t.selected=!1,this.form_field.options[t.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[t.options_index].value}),this.search_field_scale(),!0)},s.prototype.single_deselect_control_build=function(){return this.allow_single_deselect?(this.selected_item.find("abbr").length||this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'),this.selected_item.addClass("chosen-single-with-deselect")):void 0},s.prototype.get_search_text=function(){return e("<div/>").text(e.trim(this.search_field.val())).html()},s.prototype.winnow_results_set_highlight=function(){var e,t;return t=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),e=t.length?t.first():this.search_results.find(".active-result").first(),null!=e?this.result_do_highlight(e):void 0},s.prototype.no_results=function(t){var s;return s=e('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),s.find("span").first().html(t),this.search_results.append(s),this.form_field_jq.trigger("chosen:no_results",{chosen:this})},s.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},s.prototype.keydown_arrow=function(){var e;return this.results_showing&&this.result_highlight?(e=this.result_highlight.nextAll("li.active-result").first())?this.result_do_highlight(e):void 0:this.results_show()},s.prototype.keyup_arrow=function(){var e;return this.results_showing||this.is_multiple?this.result_highlight?(e=this.result_highlight.prevAll("li.active-result"),e.length?this.result_do_highlight(e.first()):(this.choices_count()>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},s.prototype.keydown_backstroke=function(){var e;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(e=this.search_container.siblings("li.search-choice").last(),e.length&&!e.hasClass("search-choice-disabled")?(this.pending_backstroke=e,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},s.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},s.prototype.keydown_checker=function(e){var t,s;switch(t=null!=(s=e.which)?s:e.keyCode,this.search_field_scale(),8!==t&&this.pending_backstroke&&this.clear_backstroke(),t){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(e),this.mouse_on_container=!1;break;case 13:this.results_showing&&e.preventDefault();break;case 32:this.disable_search&&e.preventDefault();break;case 38:e.preventDefault(),this.keyup_arrow();break;case 40:e.preventDefault(),this.keydown_arrow()}},s.prototype.search_field_scale=function(){var t,s,i,n,o,a,r,l,c;if(this.is_multiple){for(i=0,r=0,o="position:absolute; left: -1000px; top: -1000px; display:none;",a=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],l=0,c=a.length;c>l;l++)n=a[l],o+=n+":"+this.search_field.css(n)+";";return t=e("<div />",{style:o}),t.text(this.search_field.val()),e("body").append(t),r=t.width()+25,t.remove(),s=this.container.outerWidth(),r>s-10&&(r=s-10),this.search_field.css({width:r+"px"})}},s}(t)}).call(this)}.apply(e,arguments)})}(this),function(e){define("angular-chosen",["angular","jquery-chosen"],function(){return function(){(function(){var e=[].indexOf||function(e){for(var t=0,s=this.length;s>t;t++)if(t in this&&this[t]===e)return t;return-1};angular.module("localytics.directives",[]),angular.module("localytics.directives").directive("chosen",["$timeout",function(t){var s,i,n,o;return i=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,s=["persistentCreateOption","createOptionText","createOption","skipNoResults","noResultsText","allowSingleDeselect","disableSearchThreshold","disableSearch","enableSplitWordSearch","inheritSelectClasses","maxSelectedOptions","placeholderTextMultiple","placeholderTextSingle","searchContains","singleBackstrokeDelete","displayDisabledOptions","displaySelectedOptions","width","includeGroupLabelInSelected","maxShownResults"],o=function(e){return e.replace(/[A-Z]/g,function(e){return"_"+e.toLowerCase()})},n=function(e){var t;if(angular.isArray(e))return 0===e.length;if(angular.isObject(e))for(t in e)if(e.hasOwnProperty(t))return!1;return!0},{restrict:"A",require:"?ngModel",priority:1,link:function(a,r,l,c){var u,d,h,p,_,f,m,g,v,b,y;return a.disabledValuesHistory=a.disabledValuesHistory?a.disabledValuesHistory:[],r=$(r),r.addClass("localytics-chosen"),_=a.$eval(l.chosen)||{},angular.forEach(l,function(t,i){return e.call(s,i)>=0?l.$observe(i,function(e){return _[o(i)]="{{"===String(r.attr(l.$attr[i])).slice(0,2)?e:a.$eval(e),v()}):void 0}),m=function(){return r.addClass("loading").attr("disabled",!0).trigger("chosen:updated")},g=function(){return r.removeClass("loading"),angular.isDefined(l.disabled)?r.attr("disabled",l.disabled):r.attr("disabled",!1),r.trigger("chosen:updated")},u=null,d=!1,h=function(){var e;return u?r.trigger("chosen:updated"):(t(function(){u=r.chosen(_).data("chosen")}),angular.isObject(u)?e=u.default_text:void 0)},v=function(){return d?r.attr("data-placeholder",u.results_none_found).attr("disabled",!0):r.removeAttr("data-placeholder"),r.trigger("chosen:updated")},c?(f=c.$render,c.$render=function(){return f(),h()},r.on("chosen:hiding_dropdown",function(){return a.$apply(function(){return c.$setTouched()})}),l.multiple&&(y=function(){return c.$viewValue},a.$watch(y,c.$render,!0))):h(),l.$observe("disabled",function(){return r.trigger("chosen:updated")}),l.ngOptions&&c?(p=l.ngOptions.match(i),b=p[7],a.$watchCollection(b,function(e){var s;return s=t(function(){return angular.isUndefined(e)?m():(d=n(e),g(),v())})}),a.$on("$destroy",function(){return"undefined"!=typeof timer&&null!==timer?t.cancel(timer):void 0})):void 0}}}])}).call(this)}.apply(e,arguments)})}(this),define("app/services/emailAccountsService",["angular","cjt/io/uapi","cjt/io/uapi-request","cjt/util/locale"],function(e,t,s,i){var n,o="&infin;";try{n=e.module("cpanel.mail.Pops")}catch(a){n=e.module("cpanel.mail.Pops",[])}n.factory("emailAccountsService",["$q","APIService",function(t,n){var a=new n({transformAPISuccess:function(e){return e.data}}),r=function(){};return r.prototype=a,e.extend(r.prototype,{_dataWrapper:function(e){return this.deferred(e).promise},addEmailAccount:function(e){var t=new s.Class;return t.initialize("Email","add_pop",e),t.addAnalytics(),this._dataWrapper(t)},isSharedAddressBookEnabled:function(){var e=new s.Class;return e.initialize("DAV","has_shared_global_addressbook"),this._dataWrapper(e)},enableSharedAddressBook:function(){var e=new s.Class;return e.initialize("DAV","enable_shared_global_addressbook"),this._dataWrapper(e)},disableSharedAddressBook:function(){var e=new s.Class;return e.initialize("DAV","disable_shared_global_addressbook"),this._dataWrapper(e)},changePassword:function(e,t,i){var n=new s.Class;return n.initialize("Email","passwd_pop",{email:e,domain:t,password:i}),this._dataWrapper(n)},changeQuota:function(e,t,i){var n=new s.Class;return n.initialize("Email","edit_pop_quota",{email:e,domain:t,quota:i}),this._dataWrapper(n)},deleteEmailAccount:function(e,t){var i=new s.Class;return i.initialize("Email","delete_pop",{email:e,domain:t}),this._dataWrapper(i)},getEmailAccounts:function(e){this.currentGetRequest&&this.currentGetRequest.jqXHR&&this.currentGetRequest.jqXHR.abort();var a=new s.Class;e||(e={}),e.no_human_readable_keys=1,e.get_restrictions=1,a.initialize("Email","list_pops_with_disk",e);var r=t.defer(),l=this;return this.currentGetRequest=new n.AngularAPICall(a,{done:function(e){if(l.currentGetRequest=void 0,e.parsedResponse.error)r.reject(e.parsedResponse.error);
else{for(var t=e.parsedResponse,s=t.data,n=0;n<s.length;n++){var a=s[n];a.diskused=parseInt(a.diskused,10),a.humandiskused=i.format_bytes(a._diskused),0===a._diskquota||0===a.diskquota||"unlimited"===a.diskquota?(a.diskquota=0,a.humandiskquota=o,a.diskusedpercent=0):(a.diskquota=parseInt(a._diskquota,10)/1024/1024,a.humandiskquota=i.format_bytes(a._diskquota),a.diskusedpercent=(a._diskused/a._diskquota*100).toFixed(2)),a.humandiskusedpercent=i.numf(a.diskusedpercent)+"%",a.suspended_login=""+a.suspended_login=="1",a.suspended_incoming=""+a.suspended_incoming=="1",a.suspended_outgoing=""+a.suspended_outgoing=="1",a.hold_outgoing=""+a.hold_outgoing=="1",a.has_suspended=""+a.has_suspended=="1"}r.resolve(t)}},fail:function(){l.currentGetRequest=void 0}}),r.promise},getDefaultAccountUsage:function(){var e=new s.Class;return e.initialize("Email","get_main_account_disk_usage"),this._dataWrapper(e)},_createAPICall:function(e,t,n){var o=new s.Class;return o.initialize("Email",e,{email:t}),this._dataWrapper(o).then(function(){return n.success?{method:e,type:"success",message:i.makevar(n.success,t),autoClose:1e4}:{method:e,type:"success"}},function(s){return n.error?{method:e,type:"danger",message:i.makevar(n.error,t,s)}:{method:e,type:"danger"}})},getHeldMessageCount:function(e){var t=new s.Class;return t.initialize("Email","get_held_message_count",{email:e}),this._dataWrapper(t)},deleteHeldMessages:function(e,t){var i=new s.Class;return i.initialize("Email","delete_held_messages",{email:e,release_after_delete:t}),this._dataWrapper(i)},changeSuspensions:function(e,s){var n=[];return e.suspended_login&&!s.login?n.push(this._createAPICall("unsuspend_login",e.email,{success:i.translatable("You have removed the suspension on “[_1]” from logging in."),error:i.translatable("Failed to remove the suspension on “[_1]” from logging in: [_2]")})):!e.suspended_login&&s.login&&n.push(this._createAPICall("suspend_login",e.email,{success:i.translatable("You have suspended “[_1]” from logging in."),error:i.translatable("Failed to suspend “[_1]” from logging in: [_2]")})),e.suspended_incoming&&!s.incoming?n.push(this._createAPICall("unsuspend_incoming",e.email,{success:i.translatable("You have removed the suspension on “[_1]” from receiving mail."),error:i.translatable("Failed to remove the suspension on “[_1]” from receiving mail: [_2]")})):!e.suspended_incoming&&s.incoming&&n.push(this._createAPICall("suspend_incoming",e.email,{success:i.translatable("You have suspended “[_1]” from receiving mail."),error:i.translatable("Failed to suspend “[_1]” from receiving mail: [_2]")})),e.suspended_outgoing&&"suspend"!==s.outgoing?n.push(this._createAPICall("unsuspend_outgoing",e.email,{success:"hold"===s.outgoing?void 0:i.translatable("You have removed the suspension on “[_1]” from sending mail."),error:i.translatable("Failed to remove the suspension on “[_1]” from sending mail: [_2]")})):e.suspended_outgoing||"suspend"!==s.outgoing||n.push(this._createAPICall("suspend_outgoing",e.email,{success:i.translatable("You have suspended “[_1]” from sending mail."),error:i.translatable("Failed to suspend “[_1]” from sending mail: [_2]")})),e.hold_outgoing&&"hold"!==s.outgoing?n.push(this._createAPICall("release_outgoing",e.email,{success:"suspend"===s.outgoing?void 0:i.translatable("You have released outgoing mail for “[_1]”."),error:i.translatable("Failed to release outgoing mail for “[_1]”: [_2]")})):e.hold_outgoing||"hold"!==s.outgoing||n.push(this._createAPICall("hold_outgoing",e.email,{success:i.translatable("You have held “[_1]”’s outgoing mail in the mail queue."),error:i.translatable("Failed to hold “[_1]”’s outgoing mail in the mail queue: [_2]")})),n.length>0?t.all(n):t(function(e){e([])})}}),new r}])}),define("app/filters/emailLocaleString",["angular","cjt/util/locale"],function(e,t){var s;try{s=e.module("cpanel.mail.Pops")}catch(i){s=e.module("cpanel.mail.Pops",[])}s.filter("emailLocaleString",function(){return function(e,s){return t.makevar(s,e)}})}),define("app/filters/encodeURIComponent",["angular"],function(e){var t;try{t=e.module("cpanel.mail.Pops")}catch(s){t=e.module("cpanel.mail.Pops",[])}t.filter("encodeURIComponent",function(){return window.encodeURIComponent})}),define("app/filters/quotaProgressType",["angular"],function(){var e;try{e=angular.module("cpanel.mail.Pops")}catch(t){e=angular.module("cpanel.mail.Pops",[])}e.filter("quotaProgressType",function(){return function(e){return e>=80?"danger":e>=60?"warning":e>=40?"info":"success"}})}),define("app/views/listEmailAccounts",["lodash","angular","cjt/util/locale","uiBootstrap","cjt/directives/actionButtonDirective","cjt/directives/loadingPanel","cjt/directives/toggleSortDirective","cjt/directives/searchDirective","cjt/directives/pageSizeDirective","cjt/filters/startFromFilter","cjt/decorators/paginationDecorator","cjt/services/cpanel/componentSettingSaverService","cjt/services/alertService"],function(e,t,s){"use strict";var i,n="&infin;";try{i=t.module("cpanel.mail.Pops")}catch(o){i=t.module("cpanel.mail.Pops",[])}i.controller("listEmailAccountsCtrl",["$rootScope","$scope","$timeout","$location","emailAccountsService","growl","$routeParams","$window","componentSettingSaverService","ONE_MEBIBYTE","alertService",function(i,o,a,r,l,c,u,d,h,p,_){var f="EmailAccountsTable",m="EmailAccountsListFilter";o.requiredPasswordStrength=PAGE.requiredPasswordStrength,o.webmailEnabled=PAGE.webmailEnabled,o.externalAuthConfig=PAGE.externalAuthModulesConfigured,o.showCalAndContacts=PAGE.showCalendarAndContactItems,o.emailDiskUsageEnabled=PAGE.emailDiskUsageEnabled,o.defaultQuota=PAGE.userDefinedQuotaDefaultValue,o.maxQuota=PAGE.maxEmailQuota,o.expandedAccount=void 0,o.loadingEmailAccounts=!1,o.filterTermPending=!0,o.tableStatus=void 0,o.isRTL=PAGE.isRTL,o.storageKey=m,o.canSetUnlimited=void 0!==PAGE.canSetUnlimited?PAGE.canSetUnlimited:!0,o.actionModule=void 0,o.passwordChange={password:void 0,confirm:void 0},o.changingPassword=!1,o.quotaChange={quotaType:void 0,quota:void 0},o.changingQuota=!1,i.meta||(i.meta={sortReverse:!1,sortBy:"user",sortDirection:"asc",sortFields:["user","domain","has_suspended","_diskused","_diskquota","diskusedpercent_float"],filterValue:"",showPager:!1,maxPages:5,totalItems:0,currentPage:1,pageSize:20,pageSizes:[20,50,100,500],start:0,limit:10}),o.connectDevicesIcon=o.showCalAndContacts?"fa-mobile-alt":"fa-external-link-alt",o.setMetaFromComponentSettings=function(t){t.hasOwnProperty("sortBy")&&t.sortBy&&e.find(i.meta.sortFields,function(e){return e===t.sortBy})&&(i.meta.sortBy=t.sortBy),t.hasOwnProperty("sortDirection")&&t.sortDirection&&("asc"===t.sortDirection||"desc"===t.sortDirection)&&(i.meta.sortDirection=t.sortDirection),t.hasOwnProperty("pageSize")&&t.pageSize&&e.find(i.meta.pageSizes,function(e){return e===parseInt(t.pageSize)})&&(i.meta.pageSize=parseInt(t.pageSize))},o.saveMetaToComponentSettings=function(){h.set(f,{sortBy:i.meta.sortBy,sortDirection:i.meta.sortDirection,pageSize:i.meta.pageSize})},o.clearTableStatus=function(){o.tableStatus=void 0},o.clearStatus=function(e){if(e&&o.expandedAccount===e&&_.clear(void 0,"alertGroup"+i.meta.accounts.indexOf(e)),e&&e.deleted){var t=i.meta.accounts.indexOf(e);t>-1&&i.meta.accounts.splice(t,1),e===o.expandedAccount&&(o.expandedAccount=void 0),0===i.meta.accounts.length&&i.meta.totalItems>i.meta.pageSize&&(i.meta.currentPage===i.meta.totalPages&&i.meta.currentPage--,o.fetch())}},o.onModuleOpened=function(e){var s=t.element("#dt_module_row_"+e);if(s&&1===s.length){s=s[0];var i=s.getBoundingClientRect().top,n=s.getBoundingClientRect().height,o=i+n;if(o>d.innerHeight){var a=t.element("body");a.animate({scrollTop:a[0].scrollTop+(o-d.innerHeight)})}}},o.cancelAction=function(){o.expandedAccount=void 0,o.actionModule=void 0},o.onClickPassword=function(e){o.passwordChange={},o.expandedAccount===e&&"password"===o.actionModule?o.cancelAction():(o.clearStatus(o.expandedAccount),o.actionModule="password",o.expandedAccount=e,a(function(){o.onModuleOpened(i.meta.accounts.indexOf(e))},350))},o.onClickChangePassword=function(){return o.changingPassword=!0,o.clearStatus(o.expandedAccount),l.changePassword(o.expandedAccount.user,o.expandedAccount.domain,o.passwordChange.password).then(function(){_.add({message:s.maketext("Password for “[_1]” has been changed.",o.expandedAccount.user+"@"+o.expandedAccount.domain),type:"success",closeable:!0,autoClose:1e4,group:"alertGroup"+i.meta.accounts.indexOf(o.expandedAccount)}),o.changingPassword=!1,o.passwordChange={},o.actionModule=void 0},function(e){_.add({type:"danger",message:e,closeable:!0,group:"alertGroup"+i.meta.accounts.indexOf(o.expandedAccount)}),o.changingPassword=!1})},o.onClickQuota=function(e){o.expandedAccount===e&&"quota"===o.actionModule?o.cancelAction():(o.clearStatus(o.expandedAccount),o.actionModule="quota",o.expandedAccount=e,e._diskquota&&0!==e._diskquota?(o.quotaChange.quotaType="userdefined",o.quotaChange.quota=e.diskquota):(o.quotaChange.quotaType="unlimited",o.quotaChange.quota=o.defaultQuota),a(function(){o.onModuleOpened(i.meta.accounts.indexOf(e))},350))},o.onClickChangeQuota=function(){a(function(){var e,t=o.expandedAccount;return e="unlimited"===o.quotaChange.quotaType?o.canSetUnlimited?0:o.maxQuota:parseInt(o.quotaChange.quota),void 0===e||isNaN(e)?void 0:(o.changingQuota=!0,o.clearStatus(o.expandedAccount),l.changeQuota(t.user,t.domain,e).then(function(){o.changingQuota=!1;var a;a=0===e?s.maketext("Changed Quota for “[_1]” to unlimited.",t.user+"@"+t.domain):s.maketext("“[_1]”‘s quota is now [format_bytes,_2].",t.user+"@"+t.domain,e*p),_.add({type:"success",message:a,closeable:!0,autoClose:1e4,group:"alertGroup"+i.meta.accounts.indexOf(o.expandedAccount)}),0===e?(t._diskquota=0,t.diskquota="unlimited",t.humandiskquota=n,t.diskusedpercent_float=t.diskusedpercent=0):(t._diskquota=e*p,t.diskquota=e,t.humandiskquota=s.format_bytes(t._diskquota),t.diskusedpercent_float=t.diskusedpercent=(t._diskused/t._diskquota*100).toFixed(2)),t.humandiskusedpercent=s.numf(t.diskusedpercent_float)+"%",o.actionModule=void 0},function(e){o.changingQuota=!1,_.add({type:"danger",message:e,closeable:!0,group:"alertGroup"+i.meta.accounts.indexOf(o.expandedAccount)})}))},250)},o.onClickDelete=function(e){o.expandedAccount===e&&"delete"===o.actionModule?o.cancelAction():(o.clearStatus(o.expandedAccount),o.actionModule="delete",o.expandedAccount=e,a(function(){o.onModuleOpened(i.meta.accounts.indexOf(e))},350))},o.onClickDeleteConfirm=function(){return o.deletingAccount=!0,o.clearStatus(o.expandedAccount),o.expandedAccount.deleting=!0,1===i.meta.accounts.length&&i.meta.filterValue&&(o.filterTermPending=!0),l.deleteEmailAccount(o.expandedAccount.user,o.expandedAccount.domain).then(function(){var e={message:s.maketext("Account “[_1]” deleted.",o.expandedAccount.user+"@"+o.expandedAccount.domain),type:"success",closeable:!0,autoClose:1e4};o.filterTermPending=!1,o.expandedAccount.deleted=!0,i.meta.filterValue&&1===i.meta.accounts.length&&i.meta.totalItems<=i.meta.pageSize?(e.group="tableStatus",_.add(e),a(function(){i.meta.accounts=[]},250)):(e.group="alertGroup"+i.meta.accounts.indexOf(o.expandedAccount),_.add(e)),o.deletingAccount=!1,o.actionModule=void 0},function(e){_.add({type:"danger",message:e,closeable:!0,group:"alertGroup"+i.meta.accounts.indexOf(o.expandedAccount)}),o.deletingAccount=!1})},o.onClickSetup=function(e){o.showCalAndContacts?o.expandedAccount===e&&"setup"===o.actionModule?o.cancelAction():(o.actionModule="setup",o.expandedAccount=e,a(function(){o.onModuleOpened(i.meta.accounts.indexOf(e))},350)):d.open("../clientconf.html?acct="+d.encodeURIComponent(e.email),"_blank")},o.onClickSuspendOptions=function(e){if(o.expandedAccount===e&&"suspend"===o.actionModule)o.cancelAction();else{o.expandedAccount&&(o.expandedAccount.status=void 0),o.actionModule="suspend",o.expandedAccount=e;var t=e.suspended_outgoing===!0?"suspend":e.hold_outgoing===!0?"hold":"allow";o.suspendOptions={login:e.suspended_login,incoming:e.suspended_incoming,outgoing:t,currentOutgoing:t,deleteHeldMessages:0},"hold"===t&&(o.checkingHolds=!0,l.getHeldMessageCount(e.email).then(function(e){o.checkingHolds=!1,o.suspendOptions.currentlyHeld=e},function(e){o.checkingHolds=!1,_.add({type:"danger",message:e,closeable:!0,group:"alertGroup"+i.meta.accounts.indexOf(o.expandedAccount),replace:!1})})),a(function(){o.onModuleOpened(i.meta.accounts.indexOf(e))},350)}},o.onClickSaveSuspensions=function(){o.clearStatus(o.expandedAccount),o.suspending=!0;var t=o.suspendOptions.deleteHeldMessages,n=o.suspendOptions.currentOutgoing;delete o.suspendOptions.deleteHeldMessages,delete o.suspendOptions.currentOutgoing,delete o.suspendOptions.currentlyHeld;var a=i.meta.accounts.indexOf(o.expandedAccount),r=function(t){t.forEach(function(t){if(void 0!==t.message&&_.add(e.assign({closeable:!0,group:"alertGroup"+a,replace:!1},t)),"success"===t.type)switch(t.method){case"suspend_login":o.expandedAccount.suspended_login=!0;break;case"unsuspend_login":o.expandedAccount.suspended_login=!1;break;case"suspend_incoming":o.expandedAccount.suspended_incoming=!0;break;case"unsuspend_incoming":o.expandedAccount.suspended_incoming=!1;break;case"suspend_outgoing":o.expandedAccount.suspended_outgoing=!0;break;case"unsuspend_outgoing":o.expandedAccount.suspended_outgoing=!1;break;case"hold_outgoing":o.expandedAccount.hold_outgoing=!0;break;case"release_outgoing":o.expandedAccount.hold_outgoing=!1}}),o.suspending=!1,o.expandedAccount.has_suspended=o.expandedAccount.suspended_login||o.expandedAccount.suspended_incoming||o.expandedAccount.suspended_outgoing||o.expandedAccount.hold_outgoing,o.actionModule=void 0},c=function(e){e.forEach(function(e){_.add({type:"danger",message:e,closeable:!0,group:"alertGroup"+a,replace:!1})}),o.suspending=!1};if(t){var u="hold"===n&&"allow"===o.suspendOptions.outgoing?1:0;return l.deleteHeldMessages(o.expandedAccount.email,u).then(function(e){return _.add({message:s.maketext("[numf,_1] messages have been queued for deletion from the outgoing mail queue.",e),type:"success",closeable:!0,autoClose:1e4,group:"alertGroup"+a,replace:!1}),1===u&&(o.suspendOptions.outgoing="hold"),l.changeSuspensions(o.expandedAccount,o.suspendOptions).then(r,c)},function(e){o.suspending=!1,_.add({type:"danger",message:e,closeable:!0,group:"alertGroup"+a,replace:!1})})}return l.changeSuspensions(o.expandedAccount,o.suspendOptions).then(r,c)},o.sortList=function(){o.currentFetchTimeout&&a.cancel(o.currentFetchTimeout),o.currentFetchTimeout=a(function(){o.saveMetaToComponentSettings(),i.meta.currentPage=1,o.fetch()},250)},o.selectPage=function(){o.currentFetchTimeout&&a.cancel(o.currentFetchTimeout),o.currentFetchTimeout=a(function(){o.fetch()},250)},o.selectPageSize=function(){o.currentFetchTimeout&&a.cancel(o.currentFetchTimeout),o.currentFetchTimeout=a(function(){o.saveMetaToComponentSettings(),i.meta.currentPage=1,o.fetch()},250)},o.searchList=function(){o.filterTermPending=!0,o.currentFetchTimeout&&a.cancel(o.currentFetchTimeout),localStorage.setItem(o.storageKey,PAGE.securityToken+":"+i.meta.filterValue),o.currentFetchTimeout=a(function(){i.meta.currentPage=1,o.fetch()},250)},o.collapseFinished=function(){void 0===o.actionModule&&(o.expandedAccount=void 0)},o.fetch=function(){o.loadingEmailAccounts=!0,i.meta.mobileItemCountText=void 0;var n="lexicographic";"_diskused"===i.meta.sortBy||"diskusedpercent"===i.meta.sortBy||"has_suspended"===i.meta.sortBy?n="numeric":"_diskquota"===i.meta.sortBy&&(n="numeric_zero_as_max");var a={"api.sort":1,"api.sort_column":i.meta.sortBy,"api.sort_method":n,"api.sort_reverse":"asc"===i.meta.sortDirection?0:1,"api.paginate":1,"api.paginate_start":(i.meta.currentPage-1)*i.meta.pageSize,"api.paginate_size":i.meta.pageSize,"api.paginate_page":i.meta.currentPage};i.meta.filterValue&&""!==i.meta.filterValue&&(a["api.filter"]=1,a["api.filter_term_0"]=i.meta.filterValue,a["api.filter_column_0"]="login"),i.meta.accounts=[];var u=t.element("#popsAccountList");u&&u[0]&&u.css({minHeight:d.getComputedStyle(u[0]).height});var h=l.getEmailAccounts(a);o.fetchPromise=h,h.then(function(n){if(o.fetchPromise===h){var a=n.data,l=n.meta;if(0===l.paginate.total_records&&i.initialLoad&&!i.meta.filterValue)i.initialLoad=!1,r.path("/addEmailAccount");else{if(i.initialLoad=!1,i.meta.totalItems=l.paginate.total_records,i.meta.totalPages=l.paginate.total_pages,i.meta.totalItems>e.min(i.meta.pageSizes)){i.meta.showPager=!0;var c=(i.meta.currentPage-1)*i.meta.pageSize;i.meta.start=c+1,i.meta.limit=c+a.length}else i.meta.showPager=!1,i.meta.start=0===a.length?0:1,i.meta.limit=a.length;i.meta.mobileItemCountText=s.maketext("Displaying [_1] to [_2] out of [_3] records",i.meta.start,i.meta.limit,i.meta.totalItems),t.element("#popsAccountList").css({minHeight:""}),i.meta.accounts=a,o.loadingEmailAccounts=!1,o.filterTermPending=!1}}},function(e){c.error(e),o.loadingEmailAccounts=!1,o.filterTermPending=!1})},o.getSearchClass=function(){return i.initialLoad||o.filterTermPending||o.loadingEmailAccounts||!o.meta.filterValue?"":i.meta.accounts&&i.meta.accounts.length>0?"success":"danger"};var g=i.$on("emailAccountAdded",o.fetch);i.initialLoad&&PAGE.nvdata&&PAGE.nvdata.hasOwnProperty(f)&&o.setMetaFromComponentSettings(PAGE.nvdata[f]);var v=localStorage.getItem(o.storageKey);if(v&&0===v.indexOf(PAGE.securityToken+":")&&(i.meta.filterValue=v.substr(1+PAGE.securityToken.length)),u.account&&u.account!==i.meta.filterValue&&(i.meta.filterValue=u.account,i.meta.accounts=void 0),o.$on("$destroy",function(){h.unregister(f),g()}),i.initialLoad)h.register(f),a(o.fetch);else{var b=h.register(f);b&&b.then(function(e){e&&(u.account&&u.account!==e.filterValue&&(e.filterValue=u.account,i.meta.currentPage=1,i.meta.accounts=void 0,o.saveMetaToComponentSettings()),o.setMetaFromComponentSettings(e)),i.meta.accounts||o.fetch()},function(){i.meta.accounts||o.fetch()})}}])}),define("app/validators/emailAccountAllowedChars",["angular"],function(e){var t;try{t=e.module("cpanel.mail.Pops")}catch(s){t=e.module("cpanel.mail.Pops",[])}t.directive("emailAllowedChars",function(){return{require:"ngModel",restrict:"A",link:function(e,t,s,i){var n=/[^a-zA-Z0-9.\-_]/;i.$validators.emailAllowedChars=function(e,t){return i.$isEmpty(t)?!0:!n.test(t)}}}})}),define("app/validators/emailAccountFullLength",["angular"],function(e){var t;try{t=e.module("cpanel.mail.Pops")}catch(s){t=e.module("cpanel.mail.Pops",[])}t.directive("emailFulllength",function(){return{require:"ngModel",restrict:"A",link:function(e,t,s,i){function n(){return o||(o=e.$eval(s.emailOtherValue)),o}i.$validators.emailFulllength=function(e,t){var o=n();if(!o){var a=t||"";return a.length+1<=s.emailFulllength}var r=i.$isEmpty(t),l=o.$isEmpty(o.$viewValue);if(r&&l)return!0;var c=t||"",u=o.$pending||o.$invalid?o.$viewValue:o.$modelValue;return c.length+u.length+1<=s.emailFulllength},e.$watchGroup([function(){var e=n();return e&&e.$viewValue},function(){var e=n();return e&&e.$modelValue}],function(){i.$validate()});var o}}})}),define("app/validators/emailAccountSafePeriods",["angular"],function(e){var t;try{t=e.module("cpanel.mail.Pops")}catch(s){t=e.module("cpanel.mail.Pops",[])}t.directive("emailSafePeriods",function(){return{require:"ngModel",restrict:"A",link:function(e,t,s,i){i.$validators.emailSafePeriods=function(e,t){return i.$isEmpty(t)?!0:0!==t.indexOf(".")&&t.lastIndexOf(".")!==t.length-1&&-1===t.indexOf("..")}}}})}),define("app/views/addEmailAccount",["lodash","angular","cjt/util/locale","uiBootstrap","cjt/directives/actionButtonDirective","cjt/directives/bytesInput","cjt/directives/passwordFieldDirective","cjt/directives/validateEqualsDirective","cjt/directives/validationContainerDirective","cjt/directives/validationItemDirective","app/validators/emailAccountAllowedChars","app/validators/emailAccountFullLength","app/validators/emailAccountSafePeriods"],function(e,t,s){var i=t.module("cpanel.mail.Pops");i.controller("addEmailAccountCtrl",["$rootScope","$scope","emailAccountsService","ONE_MEBIBYTE",function(i,n,o){n.requiredPasswordStrength=PAGE.requiredPasswordStrength,n.userDefinedDefaultQuota=PAGE.userDefinedQuotaDefaultValue,n.mailDomains=e.map(PAGE.mailDomains,e.property("domain")),n.creatingAccount=!1,n.isRTL=PAGE.isRTL,n.selectedQuotaUnit="MB",n.canSetUnlimited=void 0!==PAGE.canSetUnlimited?PAGE.canSetUnlimited:!0,n.defaultQuota=PAGE.userDefinedQuotaDefaultValue?PAGE.userDefinedQuotaDefaultValue:void 0,n.maxQuota=PAGE.maxEmailQuota,n.emailAccount={account:void 0,domain:n.mailDomains.length>0?n.mailDomains[0]:void 0,password:void 0,password2:void 0,quota:n.defaultQuota,quotaType:PAGE.defaultQuotaSelected,sendWelcome:!0},n.clearStatus=function(){n.status=void 0},n.addEmailAccount=function(){if(n.addEmailAccountForm.$pending)return!1;var e=["add_email_account","add_email_domain","add_email_password1","add_email_password2","quota"];if(n.addEmailAccountForm.$invalid){n.addEmailAccountForm.$setSubmitted();var a=!1;return void t.forEach(e,function(e){n.addEmailAccountForm[e]&&n.addEmailAccountForm[e].$invalid&&(n.addEmailAccountForm[e].$setDirty(),a||(t.element("[name='addEmailAccountForm'] [name='"+e+"']").focus(),a=!0))})}var r={email:n.emailAccount.account,password:n.emailAccount.password,domain:n.emailAccount.domain,send_welcome_email:n.emailAccount.sendWelcome?1:0,quota:0};return"userdefined"===n.emailAccount.quotaType?r.quota=n.emailAccount.quota:n.canSetUnlimited||(r.quota=n.maxQuota),n.creatingAccount=!0,n.status=void 0,o.addEmailAccount(r).then(function(e){n.creatingAccount=!1;var t=e.replace("+","@");n.status={type:"success",message:s.maketext("Account “[_1]” created ([output,url,_2,View]).",t,"#/listEmailAccounts/"+t),closeable:!0,autoClose:1e4},n.emailAccount={account:void 0,domain:n.mailDomains.length>0?n.mailDomains[0]:void 0,quota:n.defaultQuota,quotaType:PAGE.defaultQuotaSelected,quotaUnit:"MB",sendWelcome:!0},n.addEmailAccountForm.$setUntouched(),n.addEmailAccountForm.$setPristine(),i.$broadcast("emailAccountAdded"),i.meta&&i.meta.accounts&&(i.meta.accounts=void 0)},function(e){n.status={type:"danger",message:e},n.creatingAccount=!1})},i.initialLoad=!1}])}),define("app/views/configurationOptions",["angular","cjt/util/locale"],function(e,t){var s=e.module("cpanel.mail.Pops");s.controller("configurationOptionsCtrl",["$rootScope","$scope","growl","emailAccountsService",function(e,s,i,n){s.sharedAddressBook={enabled:!1,enabling:!0,disabling:!0},s.clearStatus=function(){s.status=void 0},s.onClickEnableSharedAddressBook=function(){s.sharedAddressBook.enabled||(s.sharedAddressBook.enabling=!0,s.status=void 0,n.enableSharedAddressBook().then(function(e){s.status={message:t.maketext("Shared address book enabled."),type:"success",closeable:!0,ttl:1e4},s.sharedAddressBook.enabled=""+e.shared=="1",s.sharedAddressBook.enabling=!1},function(e){s.status={message:e,type:"danger"}}))},s.onClickDisableSharedAddressBook=function(){s.sharedAddressBook.enabled&&(s.sharedAddressBook.disabling=!0,s.status=void 0,n.disableSharedAddressBook().then(function(e){s.status={message:t.maketext("Shared address book disabled."),type:"success",closeable:!0,ttl:1e4},s.sharedAddressBook.enabled=""+e.shared=="1",s.sharedAddressBook.disabling=!1},function(e){s.status={message:e,type:"danger"}}))},n.isSharedAddressBookEnabled().then(function(e){s.sharedAddressBook.enabled=""+e.shared=="1",s.sharedAddressBook.enabling=!1,s.sharedAddressBook.disabling=!1},function(e){s.sharedAddressBook.enabling=!1,s.sharedAddressBook.disabling=!1,i.error(e)}),e.initialLoad=!1}])}),define("app/views/defaultAccount",["angular"],function(e){var t=e.module("cpanel.mail.Pops");t.controller("defaultAccountCtrl",["$rootScope","$scope","growl","emailAccountsService",function(e,t,s,i){t.emailDiskUsageEnabled=PAGE.emailDiskUsageEnabled,i.getDefaultAccountUsage().then(function(e){t.defaultAccountDiskUsed=e},function(e){s.error(e)}),e.initialLoad=!1}])}),define("app/index",["angular","cjt/modules","jquery-chosen","angular-chosen","ngRoute"],function(e){"use strict";return function(){e.module("cpanel.mail.Pops",["angular-growl","cjt2.cpanel","cjt2.services.api","cjt2.views.applicationController","ngAnimate","localytics.directives","cjt2.directives.bytesInput","cjt2.services.alert"]);var t=require(["cjt/bootstrap","app/services/emailAccountsService","app/filters/emailLocaleString","app/filters/encodeURIComponent","app/filters/quotaProgressType","app/views/listEmailAccounts","app/views/addEmailAccount","app/views/configurationOptions","app/views/defaultAccount"],function(t){var s=e.module("cpanel.mail.Pops");s.constant("ONE_MEBIBYTE",1048576),s.config(["$animateProvider","$routeProvider",function(e,t){e.classNameFilter(/(action-module|disappearing-table-row|animated-view)/),t.when("/addEmailAccount",{controller:"addEmailAccountCtrl",templateUrl:"views/addEmailAccount.ptt"}),t.when("/listEmailAccounts/:account?",{controller:"listEmailAccountsCtrl",templateUrl:"views/listEmailAccounts.ptt"}),window.PAGE.defaultAccountEnabled&&t.when("/defaultAccount",{controller:"defaultAccountCtrl",templateUrl:"views/defaultAccount.ptt"}),window.PAGE.showConfigSection&&t.when("/configurationOptions",{controller:"configurationOptionsCtrl",templateUrl:"views/configurationOptions.ptt"}),t.otherwise("/listEmailAccounts")}]);var i={"/addEmailAccount":0,"/listEmailAccounts":1,"/defaultAccount":2,"/configurationOptions":3};s.controller("baseController",["$rootScope","$location","$scope",function(e,t,s){e.initialLoad=!0,s.pageTabs=[],s.loading=!0,s.activeTab=-1,s.showDefaultAccount=window.PAGE.defaultAccountEnabled,s.showConfigSection=window.PAGE.showConfigSection,e.$on("$routeChangeStart",function(){s.loading=!0}),e.$on("$routeChangeSuccess",function(){s.loading=!1,t.path().indexOf("/listEmailAccounts")>-1?(s.activeTab=i["/listEmailAccounts"],e.createdAccounts=0):s.activeTab=i[t.path()]}),e.$on("$routeChangeError",function(){s.loading=!1}),s.go=function(e){t.path(e)}}]),s.animation(".action-module",["$animateCss",function(e){return{enter:function(t,s){var i=t[0].offsetHeight;return e(t,{from:{height:"0"},to:{height:i+"px"},duration:.3,easing:"ease-out",event:"enter",structural:!0}).start().done(function(){t[0].style.height="",s()})},leave:function(t,s){var i=t[0].offsetHeight;return e(t,{event:"leave",structural:!0,from:{height:i+"px"},to:{height:"0"},duration:.3,easing:"ease-out"}).start().done(function(){s()})}}}]),t("#body-content","cpanel.mail.Pops")});return t}});