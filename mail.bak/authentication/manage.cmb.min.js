define("app/services/manageService",["angular","cjt/io/api","cjt/io/uapi-request","cjt/io/uapi"],function(e,r,n){function t(e){var t={},i=[];return t.get_providers=function(){var t=e.defer(),i=new n.Class;return i.initialize("ExternalAuthentication","configured_modules"),r.promise(i.getRunArguments()).done(function(e){e=e.parsedResponse,e.status?t.resolve(e):t.reject(e.error)}),t.promise},t.get_links=function(){return i},t.fetch_links=function(t){var o=e.defer(),a=new n.Class;return a.initialize("ExternalAuthentication","get_authn_links"),t&&a.addArgument("username",t),r.promise(a.getRunArguments()).done(function(e){e=e.parsedResponse,e.status?o.resolve(e):o.reject(e.error)}),o.promise.then(function(e){i=e.data}),o.promise},t.unlink=function(t,i,o){var a=e.defer(),u=new n.Class;return u.initialize("ExternalAuthentication","remove_authn_link"),u.addArgument("provider_id",t),u.addArgument("subject_unique_identifier",i),u.addArgument("username",o),r.promise(u.getRunArguments()).done(function(e){e=e.parsedResponse,e.status?a.resolve(e):a.reject(e.error)}),a.promise},t}var i=e.module("App");return t.$inject=["$q"],i.factory("manageService",t)}),define("app/views/manageController",["angular","cjt/util/locale","uiBootstrap"],function(e,r){var n=e.module("App"),t=n.controller("manageController",["$scope","$routeParams","manageService","growl",function(e,n,t,i){e.unlink=function(o,a){var u=t.unlink(o.provider_id,o.subject_unique_identifier,n.username).then(function(){t.fetch_links(n.username).then(function(){e.providers=t.get_links()},function(e){i.error(r.maketext("The system encountered an error while it tried to retrieve results, please refresh the interface: [_1]",e)),o.disabled=0}),i.success(r.maketext("Successfully unlinked the “[_1]” account “[_2]”",a,o.preferred_username))},function(e){i.error(r.maketext("The system encountered an error while it tried to retrieve results, please refresh the interface: [_1]",e)),o.disabled=0});return u},e.init=function(){e.username=n.username,e.locale=r,e.providers=t.get_links()},e.init()}]);return t}),define("app/manage",["angular","cjt/core","cjt/modules","uiBootstrap","ngRoute"],function(e,r){return function(){e.module("App",["ui.bootstrap","angular-growl","cjt2.cpanel"]);var n=require(["uiBootstrap","app/services/manageService","app/views/manageController"],function(){var n=e.module("App");n.controller("BaseController",["$rootScope","$scope","$route","$location","manageService","growl",function(e,r,n,t,i){r.loading=!1,e.$on("$routeChangeStart",function(){r.loading=!0}),e.$on("$routeChangeSuccess",function(){r.loading=!1}),e.$on("$routeChangeError",function(){r.loading=!1}),r.current_route_matches=function(e){return t.path().match(e)},r.go=function(e){t.path(e)},window.service=i}]),n.config(["$routeProvider","$locationProvider",function(e){function n(e,r,n){return e.fetch_links(r.current.params.username).then(function(){},function(e){n.error(LOCALE.maketext("The system encountered an error while it tried to retrieve results, please refresh the interface: [_1]",e))})}e.when("/:username",{controller:"manageController",templateUrl:r.buildFullPath("mail/authentication/views/manageView.ptt"),resolve:{providers:["manageService","$route","growl",n]}}),e.otherwise({redirectTo:"/:username"})}]),n.init=function(){var r=e.element("#content");return null!==r[0]&&e.bootstrap(r[0],["App"]),n},n.init()});return n}});