define("app/services/configService",["angular","cjt/io/api","cjt/io/uapi-request","cjt/io/uapi"],function(e,t,n){var i=e.module("App");i.factory("configService",["$q",function(e){return{fetchBasicList:function(i,o){var a=e.defer(),r=new n.Class;return r.initialize("LangPHP","php_ini_get_user_basic_directives"),r.addArgument("type",i),"home"!==i&&r.addArgument("vhost",o),t.promise(r.getRunArguments()).done(function(e){e=e.parsedResponse,e.status?a.resolve(e.data):a.reject(e.error)}),a.promise},getHandlerForDomain:function(i,o){var a=e.defer(),r=new n.Class;return r.initialize("LangPHP","php_get_domain_handler"),r.addArgument("type",i),"home"!==i&&r.addArgument("vhost",o),t.promise(r.getRunArguments()).done(function(e){e=e.parsedResponse,e.status?a.resolve(e.data):a.reject(e.error)}),a.promise},applySettings:function(i,o,a){var r=e.defer(),s=new n.Class;return s.initialize("LangPHP","php_ini_set_user_basic_directives"),"home"!==i&&s.addArgument("vhost",o),s.addArgument("type",i),"undefined"!=typeof a&&a.length>0&&a.forEach(function(e,t){s.addArgument("directive-"+t,e.key+":"+e.value)}),t.promise(s.getRunArguments()).done(function(e){e=e.parsedResponse,e.status?r.resolve(e.data):r.reject(e.error)}),r.promise},fetchContent:function(i,o){var a=e.defer(),r=new n.Class;return r.initialize("LangPHP","php_ini_get_user_content"),r.addArgument("type",i),"home"!==i&&r.addArgument("vhost",o),t.promise(r.getRunArguments()).done(function(e){e=e.parsedResponse,e.status?a.resolve(e.data.content):a.reject(e.error)}),a.promise},saveIniContent:function(i,o,a){var r=e.defer(),s=new n.Class;return s.initialize("LangPHP","php_ini_set_user_content"),s.addArgument("content",i),s.addArgument("type",o),"home"!==o&&s.addArgument("vhost",a),t.promise(s.getRunArguments()).done(function(e){e=e.parsedResponse,e.status?r.resolve(e.data):r.reject(e.error)}),r.promise}}}])}),define("app/views/basicMode",["angular","lodash","cjt/util/locale","uiBootstrap","cjt/directives/alertList","cjt/directives/spinnerDirective","cjt/decorators/growlDecorator","cjt/services/alertService","app/services/configService","cjt/directives/actionButtonDirective"],function(e,t,n){var i=e.module("App"),o=i.controller("basicMode",["$scope","$location","configService","$routeParams","$timeout","spinnerAPI","alertService","growl","growlMessages",function(e,i,o,a,r,s,c,l,u){var d,p=[],h=!1;e.noIniPaths=!0,e.txtInFirstOption=n.maketext("[comment,used for highlight in select option]-- Not Available --[comment,used for highlight in select option]"),e.selectedIniPath={type:"",name:""},e.iniPathNames=[],e.loadingDirectiveList=!1,e.showEmptyMessage=!1,e.knobLabel=" ";var m=function(){e.directiveList=[],e.showEmptyMessage=!1};e.loadDirectives=function(){if(u.destroyAllMessages(),e.selectedIniPath.type){s.start("loadingSpinner");var i=e.selectedIniPath;e.loadingDirectiveList=!0,h=!1;var a=g(e.selectedIniPath);return"home"===a.type?a.inifullpath=a.homedir+"/"+a.path:"vhost"===a.type&&(a.inifullpath=a.documentroot+"/"+a.path),e.currentIniPathInfo=a,o.fetchBasicList(i.type,i.name).then(function(a){if("undefined"!=typeof a.directives&&a.directives.length>0){var r=a.directives;return o.getHandlerForDomain(i.type,i.name).then(function(i){"suphp"!==i.php_handler&&(r=t.filter(r,function(e){return"PHP_INI_SYSTEM"!==e.php_ini_mode})),e.directiveList=r.map(function(e){e.toggleValue="On"===e.value?!0:!1;var t=e.default_value;return"undefined"!=typeof e.cpanel_default&&null!==e.cpanel_default&&(t=e.cpanel_default),"boolean"===e.type&&(t=n.maketext("1"===e.default_value?"Enabled":"Disabled")),e.default_text=n.maketext("[asis,PHP] Default: [output,class,_1,defaultValue]",t),e})},function(e){l.error(e)})}},function(e){l.error(e)}).then(function(){e.loadingDirectiveList=!1,s.stop("loadingSpinner")}).finally(function(){s.stop("loadingSpinner"),e.showEmptyMessage=""!==e.selectedIniPath&&e.directiveList.length<=0})}m()};var f=function(){h||(h=!0,l.info(n.maketext("You must click “[_1]” to apply the new changes.",n.maketext("Apply")),{ttl:-1,onopen:function(){d=this}}))};e.toggle_status=function(e){"On"===e.value?(e.value="Off",e.toggleValue=!1):(e.value="On",e.toggleValue=!0),f()},e.directiveTextChange=function(t){f();var i=t.type,o=t.value||"",a=!0,r="";if("integer"===i){var s="[~!]?\\s*E_(?:(?:(?:CORE_|COMPILE_|USER_)?(?:ERROR|WARNING))|(?:USER_)?(?:NOTICE|DEPRECATED)|PARSE|STRICT|RECOVERABLE_ERROR|ALL)",c="[&|^]",l=new RegExp("^\\s*"+s+"(?:\\s*"+c+"\\s*"+s+")*$");/^-?\d+[kmg]?$/i.test(o)||l.test(o)?a=!0:(a=!1,r=n.maketext("You must provide either an integer value, a [output,url,_1,shorthand byte,target,blank,title,shorthand byte documentation], or a [output,url,_2,predefined constant,target,blank,title,predefined constant documentation].","http://php.net/manual/en/faq.using.php#faq.using.shorthandbytes","http://php.net/manual/en/errorfunc.constants.php"))}else"float"===i&&(/^-?\d+(?:\.\d*)?$/.test(o)?a=!0:(a=!1,r=n.maketext("You must provide a valid float value.")));e.basicModeForm["txt"+t.key].$setValidity("pattern",a),t.validationMsg=r},e.disableApply=function(){return e.noIniPaths||!e.selectedIniPath.type||!e.basicModeForm.$valid},e.requiredValidation=function(e){return"string"!==e.type&&"boolean"!==e.type},e.applyPhpSettings=function(){return e.basicModeForm.$valid?(u.destroyAllMessages(),h=!1,"undefined"!=typeof d&&d.destroy(),o.applySettings(e.selectedIniPath.type,e.selectedIniPath.name,e.directiveList).then(function(e){void 0!==e&&l.success(n.maketext("Successfully applied the settings."))},function(e){l.error(t.unescape(e))})):void 0};var g=function(e){var n=t.find(p,function(t){return"home"===e.type&&"home"===t.type?!0:"vhost"===e.type&&e.name===t.vhost?!0:void 0});return n},v=function(i){if(i.length>0){p=i;var o;t.each(i,function(t){"home"===t.type||t.main_domain?t.main_domain&&(o=t.vhost):e.iniPathNames.push({type:t.type,name:t.vhost})}),e.iniPathNames=t.sortBy(e.iniPathNames,"name"),e.iniPathNames.unshift({type:"vhost",name:o}),e.iniPathNames.unshift({type:"home",name:"Home Directory"})}e.iniPathNames.length>0&&(e.noIniPaths=!1,e.txtInFirstOption=n.maketext("[comment,used for highlight in select option]-- Select a location --[comment,used for highlight in select option]"))};e.$on("$viewContentLoaded",function(){u.destroyAllMessages();var t=PAGE.php_ini_data;if(e.localeIsRTL=PAGE.locale_is_RTL?!0:!1,!t.status&&t.errors.length>0){var i=t.errors;i.forEach(function(e){c.add({type:"danger",message:e,id:"alertMessages",replace:!1,closeable:!0})}),l.error(n.maketext("Errors occurred while retrieving the [asis,PHP INI] locations."))}else v(t.data.paths)})}]);return o}),define("app/views/editorMode",["angular","lodash","cjt/util/locale","jquery","ace","uiBootstrap","cjt/directives/alertList","cjt/services/alertService","cjt/decorators/growlDecorator","app/services/configService"],function(e,t,n,i){var o=e.module("App"),a=o.controller("editorMode",["$scope","$location","$routeParams","$timeout","spinnerAPI","alertService","growl","growlMessages","configService",function(e,o,a,r,s,c,l,u,d){var p,h=[],m=!1;e.noIniPaths=!0,e.txtInFirstOption=n.maketext("[comment,used for highlight in select option]-- Not Available --[comment,used for highlight in select option]"),e.selectedIniPath={type:"",name:""},e.iniPathNames=[],e.processingEditor=!1;var f;e.loadContent=function(){if(u.destroyAllMessages(),e.selectedIniPath.type){s.start("loadingSpinner");var t=e.selectedIniPath;g(!0),m=!1;var o=v(e.selectedIniPath);return"home"===o.type?o.inifullpath=o.homedir+"/"+o.path:"vhost"===o.type&&(o.inifullpath=o.documentroot+"/"+o.path),e.currentIniPathInfo=o,d.fetchContent(t.type,t.name).then(function(t){if("undefined"!==t){""===t&&l.info(n.maketext("The [asis,INI] content does not exist. You may add new content."));var o=i("<div/>").html(t).text();"undefined"==typeof f&&(f=ace.edit("editor"),f.$blockScrolling=1/0,f.setShowPrintMargin(!1)),f.focus(),f.scrollToRow(0),f.setTheme("ace/theme/chrome");var a=ace.createEditSession(o);f.setSession(a),"undefined"!=typeof a&&(a.setMode("ace/mode/ini"),f.on("change",e.informUser))}},function(e){l.error(e)}).then(function(){g(!1)}).finally(function(){s.stop("loadingSpinner")})}},e.informUser=function(){m||(m=!0,l.info(n.maketext("You must click “[_1]” to apply the new changes.",n.maketext("Save")),{ttl:-1,onopen:function(){p=this}}))},e.save=function(){u.destroyAllMessages(),m=!1,"undefined"!=typeof p&&p.destroy(),g(!0);var i=t.escape(f.getSession().getValue());return d.saveIniContent(i,e.selectedIniPath.type,e.selectedIniPath.name).then(function(e){"undefined"!=typeof e&&l.success(n.maketext("Successfully saved the changes."))},function(e){l.error(t.escape(e))}).then(function(){g(!1)})};var g=function(t){"undefined"!=typeof f&&f.setReadOnly(t),e.processingEditor=t},v=function(e){var n=t.find(h,function(t){return"home"===e.type&&"home"===t.type?!0:"vhost"===e.type&&e.name===t.vhost?!0:void 0});return n},y=function(i){if(i.length>0){h=i;var o;t.each(i,function(t){"home"===t.type||t.main_domain?t.main_domain&&(o=t.vhost):e.iniPathNames.push({type:t.type,name:t.vhost})}),e.iniPathNames=t.sortBy(e.iniPathNames,"name"),e.iniPathNames.unshift({type:"vhost",name:o}),e.iniPathNames.unshift({type:"home",name:"Home Directory"})}e.iniPathNames.length>0&&(e.noIniPaths=!1,e.txtInFirstOption=n.maketext("[comment,used for highlight in select option]-- Select a location --[comment,used for highlight in select option]"))};e.$on("$viewContentLoaded",function(){u.destroyAllMessages();var e=PAGE.php_ini_data;if(!e.status&&e.errors.length>0){var t=e.errors;t.forEach(function(e){c.add({type:"danger",message:e,id:"alertMessages",replace:!1,closeable:!0})}),l.error(n.maketext("Errors occurred while retrieving the [asis,PHP INI] locations."))}y(e.data.paths)})}]);return a}),define("app/index",["angular","jquery","lodash","cjt/core","cjt/modules","ngRoute","uiBootstrap","ngAnimate"],function(e,t,n,i){return function(){e.module("App",["ngRoute","ui.bootstrap","ngAnimate","angular-growl","cjt2.cpanel"]);var t=require(["cjt/bootstrap","app/views/basicMode","app/views/editorMode"],function(t){var n=e.module("App");n.firstLoad={phpAccountList:!0},n.config(["$routeProvider","$locationProvider",function(e){e.when("/basic",{controller:"basicMode",templateUrl:i.buildFullPath("multiphp_ini_editor/views/basicMode.html.tt"),reloadOnSearch:!1}),e.when("/editor",{controller:"editorMode",templateUrl:i.buildFullPath("multiphp_ini_editor/views/editorMode.html.tt"),reloadOnSearch:!1}),e.otherwise({redirectTo:"/basic"})}]),n.run(["$rootScope","$location","growlMessages",function(e,t,n){e.$on("$routeChangeStart",function(){e.currentRoute=t.path(),n.destroyAllMessages()})}]),t("#content","App")});return t}});