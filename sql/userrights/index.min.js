define(["angular","lodash","cjt/util/locale","cjt/io/uapi-request","cjt/io/uapi","cjt/modules","cjt/directives/formWaiting","cjt/services/alertService","cjt/directives/alert","cjt/directives/alertList","uiBootstrap","cjt/services/APICatcher"],function(angular,_,LOCALE,APIREQUEST){"use strict";return function(){var app=require(["cjt/bootstrap"],function(BOOTSTRAP){var app=angular.module("App",["cjt2.cpanel","ui.bootstrap"]);app.controller("BaseController",["$rootScope","$scope","APICatcher","alertService",function($rootScope,$scope,api,alertService){angular.extend($scope,{save_privs:function savePrivs(ngForm){var theForm=document.forms[ngForm.$name];var privsStr;if(theForm.ALL.checked){privsStr="ALL"}else{privsStr="";var privs=[].slice.call(theForm.privileges);for(var p=0;p<privs.length;p++){if(privs[p].checked){privsStr+=","+privs[p].value}}privsStr=privsStr.replace(/^,/,"")}var apicall=(new APIREQUEST.Class).initialize("Mysql","set_privileges_on_database",{user:CPANEL.PAGE.username,database:CPANEL.PAGE.dbname,privileges:privsStr});return api.promise(apicall).then(function(resp){var els=[].slice.call(theForm.elements);for(var e=0;e<els.length;e++){if(els[e].type==="checkbox"){els[e].defaultChecked=els[e].checked}}alertService.add({type:"success",message:LOCALE.maketext("You saved “[_1]”’s privileges on the database “[_2]”.",_.escape(CPANEL.PAGE.username),_.escape(CPANEL.PAGE.dbname)),closeable:true,replace:false,autoClose:1e4,group:"userrights"})})}})}]);BOOTSTRAP("#ng_content","App")});return app}});