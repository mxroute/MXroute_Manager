define("app/services/manageService",["angular","cjt/io/api","cjt/io/uapi-request","cjt/io/uapi"],function(e,r,t){function n(e){var n={},i=[];return n.get_providers=function(){var n=e.defer(),i=new t.Class;return i.initialize("ExternalAuthentication","configured_modules"),r.promise(i.getRunArguments()).done(function(e){e=e.parsedResponse,e.status?n.resolve(e):n.reject(e.error)}),n.promise},n.get_links=function(){return i},n.fetch_links=function(n){var a=e.defer(),o=new t.Class;return o.initialize("ExternalAuthentication","get_authn_links"),n&&o.addArgument("username",n),r.promise(o.getRunArguments()).done(function(e){e=e.parsedResponse,e.status?a.resolve(e):a.reject(e.error)}),a.promise.then(function(e){i=e.data}),a.promise},n.unlink=function(n,i,a){var o=e.defer(),u=new t.Class;return u.initialize("ExternalAuthentication","remove_authn_link"),u.addArgument("provider_id",n),u.addArgument("subject_unique_identifier",i),u.addArgument("username",a),r.promise(u.getRunArguments()).done(function(e){e=e.parsedResponse,e.status?o.resolve(e):o.reject(e.error)}),o.promise},n}var i=e.module("App");return n.$inject=["$q"],i.factory("manageService",n)}),define("app/views/manageController",["angular","cjt/util/locale","uiBootstrap","cjt/directives/alertList","cjt/services/alertService"],function(e,r){"use strict";var t=e.module("App"),n=t.controller("manageController",["$scope","$routeParams","manageService","alertService",function(e,t,n,i){e.unlink=function(a,o){var u=n.unlink(a.provider_id,a.subject_unique_identifier,t.username).then(function(){n.fetch_links(t.username).then(function(){e.providers=n.get_links()},function(e){i.add({type:"danger",message:r.maketext("The system encountered an error while it tried to retrieve results, please refresh the interface: [_1]",e),closeable:!0,replace:!1,group:"emailExternalAuth"}),a.disabled=0}),i.add({type:"success",message:r.maketext("Successfully unlinked the “[_1]” account “[_2]”",o,a.preferred_username),closeable:!0,replace:!1,autoClose:1e4,group:"emailExternalAuth"})},function(e){i.add({type:"danger",message:r.maketext("The system encountered an error while it tried to retrieve results, please refresh the interface: [_1]",e),closeable:!0,replace:!1,group:"emailExternalAuth"}),a.disabled=0});return u},e.init=function(){e.username=t.username,e.locale=r,e.providers=n.get_links()},e.init()}]);return n}),define("app/manage",["angular","cjt/core","cjt/modules","uiBootstrap","ngRoute"],function(e,r){"use strict";return function(){e.module("App",["ui.bootstrap","cjt2.cpanel"]);var t=require(["uiBootstrap","cjt/directives/alert","cjt/directives/alertList","cjt/services/alertService","app/services/manageService","app/views/manageController"],function(){var t=e.module("App");t.controller("BaseController",["$rootScope","$scope","$route","$location","manageService","alertService",function(e,r,t,n,i){r.loading=!1,e.$on("$routeChangeStart",function(){r.loading=!0}),e.$on("$routeChangeSuccess",function(){r.loading=!1}),e.$on("$routeChangeError",function(){r.loading=!1}),r.current_route_matches=function(e){return n.path().match(e)},r.go=function(e){n.path(e)},window.service=i}]),t.config(["$routeProvider","$locationProvider",function(e){function t(e,r,t){return e.fetch_links(r.current.params.username).then(function(){},function(e){t.add({type:"danger",message:LOCALE.maketext("The system encountered an error while it tried to retrieve results, please refresh the interface: [_1]",e),closeable:!0,replace:!1,group:"emailExternalAuth"})})}e.when("/:username",{controller:"manageController",templateUrl:r.buildFullPath("mail/authentication/views/manageView.ptt"),resolve:{providers:["manageService","$route","alertService",t]}}),e.otherwise({redirectTo:"/:username"})}]),t.init=function(){var r=e.element("#content");return null!==r[0]&&e.bootstrap(r[0],["App"]),t},t.init()});return t}});