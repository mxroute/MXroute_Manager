define("app/controllers/ROUTES",["cjt/util/locale","cjt/core"],function(e,t){"use strict";var i=[{id:"listDomains",route:"/",hideTitle:!0,controller:"ListDomainsController",controllerAs:"listDomains",templateUrl:t.buildFullPath("shared/js/email_deliverability/views/listDomains.ptt"),title:e.maketext("List Domains"),resolve:{initialDomains:["DomainsService",function(e){return e.fetchAll()}]}},{id:"manageDomain",route:"/manage",controller:"ManageDomainController",controllerAs:"manageDomain",templateUrl:t.buildFullPath("shared/js/email_deliverability/views/manageDomain.ptt"),hideTitle:!0,title:e.maketext("Manage the Domain"),resolve:{initialDomains:["DomainsService",function(e){return e.fetchAll()}]},parentID:"listDomains"},{id:"manageDomainSPF",route:"/manage/spf",controller:"ManageDomainSPFController",controllerAs:"manageDomainSPF",templateUrl:t.buildFullPath("shared/js/email_deliverability/views/manageDomainSPF.ptt"),hideTitle:!0,title:e.maketext("Customize an [output,abbr,SPF,Sender Policy Framework] Record"),resolve:{initialDomains:["DomainsService",function(e){return e.fetchAll()}]},parentID:"manageDomain"},{id:"manageDomainDKIM",route:"/manage/dkim",controller:"ManageDomainDKIMController",controllerAs:"manageDomainDKIM",templateUrl:t.buildFullPath("shared/js/email_deliverability/views/manageDomainDKIM.ptt"),hideTitle:!0,title:e.maketext("View a [output,acronym,DKIM,Domain Keys Identified Mail] Private Key"),resolve:{initialDomains:["DomainsService",function(e){return e.fetchAll()}]},parentID:"manageDomain"}];return i.forEach(function(e){e.breadcrumb={id:e.id,name:e.title,path:e.route,parentID:e.parentID}}),i}),define("app/controllers/route",["angular","app/controllers/ROUTES","cjt/directives/breadcrumbs","cjt/services/alertService"],function(e,t){"use strict";var i="cpanel.emailDeliverability.controllers.route",s=[],r="RouteController",n=["$scope","$rootScope","$location","alertService"],o=function(i,s,r,n){function o(e){var t;return i.routes.forEach(function(i,s){i.route===e&&(t=s)}),t}function a(e){var t;return i.routes.forEach(function(i){i.id===e&&(t=i)}),t}function c(){s.$on("$routeChangeStart",function(){i.loading=!0,n.clear("danger")}),s.$on("$routeChangeSuccess",function(e,t){if(i.loading=!1,i.parentTab=null,t){var s=o(t.$$route.originalPath);i.currentTab=i.routes[s],i.activeTab=s,i.currentTab&&(i.parentTab=a(i.currentTab.parentRoute))}}),s.$on("$routeChangeError",function(){i.loading=!1})}e.extend(i,{activeTab:0,currentTab:null,routes:t}),c()};n.push(o);var a=e.module(i,s);return a.controller(r,n),{"class":o,namespace:i}}),define("shared/js/email_deliverability/services/Domain.class",["lodash"],function(e){"use strict";var t=function(t){function i(e){Object.keys(e).forEach(function(t){g[t]=e[t]}),g.protocol="http",g.isWildcard=g.domain&&"*"===g.domain.substr(0,1),v.forEach(function(e){if(!g[e])throw new Error("“"+e+"” is a required parameter.")})}function s(t){if(e.isUndefined(t.recordType))throw new Error("recordType must be defined on a record");if(e.isUndefined(t.valid))throw new Error("valid must be defined on a record of type “"+t.recordType+"” for domain “"+this.domain+"”");this.records.push(t)}function r(e){this._recordTypesLoaded=e,this.recordsLoaded=!0,this._recordsTypesWithIssues=[],e.forEach(function(e){var t=this.getRecords(e);1===t.length&&t[0].valid||this._recordsTypesWithIssues.push(e)},this),this.recordsValid=0===this._recordsTypesWithIssues.length}function n(){return this._recordTypesLoaded}function o(){this.recordsLoaded=!1,this.recordTypesLoaded=[],this.reloadingIn=0,this.records=[],this.hasNSAuthority=!1,this.recordsValid=!1,this._recordsTypesWithIssues=[]}function a(e){return-1===this._recordsTypesWithIssues.indexOf(e)}function c(e){var t=this.records;return e&&(t=t.filter(function(t){return-1!==e.indexOf(t.recordType)?!0:!1})),t}function l(e){return this.recordsLoaded&&this.isRecordValid(e)?this.getCurrentRecord(e):this._suggestedRecords[e]}function d(e,t){this._suggestedRecords[e]=t}function u(e){return this._expectedMatch[e]}function h(e,t){this._expectedMatch[e]=t}function p(e){var t=this.getRecords([e]),i=t[0];return i?i.current:{}}function m(){return this._recordsTypesWithIssues}function f(e,t){this.mailIP.version=e,this.mailIP.address=t}function _(){return this.mailIP}var g=this,v=["domain"];this.records=[],this._recordDetails={},this.reloadingIn=0,this.nameservers=[],this.zone="",this.recordsLoaded=!1,this.recordsValid=!1,this._recordTypesLoaded=[],this._recordsTypesWithIssues=[],this._suggestedRecords={},this._expectedMatch={},this.hasNSAuthority=!1,this.mailIP={version:null,address:null},this.init=i.bind(this),this.addRecord=s.bind(this),this.setRecordsLoaded=r.bind(this),this.getRecords=c.bind(this),this.isRecordValid=a.bind(this),this.getRecordTypesWithIssues=m.bind(this),this.getSuggestedRecord=l.bind(this),this.setSuggestedRecord=d.bind(this),this.getExpectedMatch=u.bind(this),this.setExpectedMatch=h.bind(this),this.resetRecordLoaded=o.bind(this),this.setMailIP=f.bind(this),this.getMailIP=_.bind(this),this.getRecordTypesLoaded=n.bind(this),this.getCurrentRecord=p.bind(this),this.init(t)};return e.assign(t.prototype,{setRecordDetails:function(e,t){if(!/^[a-z]+$/.test(e))throw new Error("Invalid record type: "+e);this._recordDetails[e]=t},getRecordDetails:function(e){if(!this._recordDetails.hasOwnProperty(e))throw new Error("No stored details: "+e);return this._recordDetails[e]}}),t}),define("shared/js/email_deliverability/services/domainFactory",["lodash","shared/js/email_deliverability/services/Domain.class"],function(e,t){"use strict";function i(e,i){function r(e){return e.homedir=this._mainHomedir,e.documentRoot=e.documentRoot||e.dir,e.rootDomain=e.rootDomain||e.rootdomain||this._mainDomain,e.redirectsTo="not redirected"===e.status?null:e.status,delete e.dir,delete e.rootdomain,delete e.status,e}function n(e){var i=this._cleanRaw(e);return new t(i)}function o(){return s}function a(e){this._mainHomedir=e}function c(e){this._mainDomain=e}function l(){return t}this._mainHomedir=e,this._mainDomain=i,this._cleanRaw=r.bind(this),this.create=n.bind(this),this.setMainHomedir=a.bind(this),this.setMainDomain=c.bind(this),this.getTypeConstants=o.bind(this),this.getClass=l.bind(this)}var s={SUBDOMAIN:"subdomain",ADDON:"addon",ALIAS:"alias",MAIN:"main_domain"};return new i}),define("shared/js/email_deliverability/services/DKIMRecordProcessor",[],function(){"use strict";function e(){function e(){return{module:"EmailAuth",func:"validate_current_dkims"}}function t(){return{module:"EmailAuth",func:"enable_dkim"}}function i(e){var t=[];return e&&(t=e.records.map(this.parseRecord.bind(this))),t}function s(e){var t=[];return e.forEach(function(e){t.push(this.processResultItem(e))},this),t}function r(e){return e.recordType="dkim",this.validateState(e)}function n(e){switch(e.valid=!1,e.state){case"MISMATCH":case"PERMFAIL":break;case"PASS":case"VALID":e.valid=!0}return e}function o(e){return e.data.forEach(function(e){var t=e.domain;e.records.forEach(function(e){e.current={name:t+".",value:e.current}})}),e}function a(e){return{name:e.domain+".",value:e.expected}}this.generateSuggestedRecord=a.bind(this),this.normalizeResults=o.bind(this),this.getValidateAPI=e.bind(this),this.getInstallAPI=t.bind(this),this.processResultItem=i.bind(this),this.processResultItems=s.bind(this),this.parseRecord=r.bind(this),this.validateState=n.bind(this)}return new e}),define("shared/js/email_deliverability/services/spfParser",["lodash"],function(e){"use strict";function t(e,t,i){var s=i.match(t),r=s[1];if(!r)return null;if(":"===r||"/"===r)throw new o("Blank argument for the "+e+" mechanism","error");return/^:/.test(r)&&(r=r.replace(/^:/,"")),r}function i(e,t,i){return s(e,t,i,!0)}function s(e,t,i,s){var r=i.match(t)[1];if(!s&&!r)throw new o("Missing mandatory argument for the "+e+" mechanism","error");if(":"===r||"="===r)throw new o("Blank argument for the "+e+" mechanism","error");return/^(:|=)/.test(r)&&(r=r.replace(/^(:|=)/,"")),r}function r(e,t){var i=e.match(d),s={};if(null!==i){var r=i[1],n=i[2];r?(s.prefix=r,s.prefixdesc=c[r]):l.test(n)?s.prefix="v":(s.prefix="+",s.prefixdesc=c["+"]);var u=!1;for(var h in a)if(Object.prototype.hasOwnProperty.call(a,h)){var p=a[h];if(p.pattern.test(n)){if(u=!0,s.type=h,s.description=p.description,p.validate)try{var m=p.validate.call(p,n);"undefined"!=typeof m&&null!==m&&(s.value=m)}catch(f){if(f instanceof o){t.push({message:f.message,type:f.type});break}}break}}u||t.push({message:"Unknown standalone term '".concat(n,"'"),type:"error"})}return s}function n(t){t=t.trim();var i={mechanisms:[],messages:[],valid:!1};if(!l.test(t))return i.messages.push({message:"No valid version found, record must start with 'v=spf1'",type:"error"}),i;var s=t.split(/\s+/),n=s.filter(function(e){return new RegExp("=").test(e)}).map(function(e){return e.match(/^(.*?)=/)[1]}).filter(function(t,i,s){return e.includes(s,t,i+1)});if(n&&n.length>0)return i.messages.push({type:"error",message:'Modifiers like "'.concat(n[0],'" may appear only once in an SPF string')}),i;var o=s.map(function(e){return e.replace(/^(\+|-|~|\?)/,"")}).filter(function(t,i,s){return e.includes(s,t,i+1)});o&&o.length>0&&i.messages.push({type:"warning",message:"One or more duplicate mechanisms were found in the policy"});try{for(var a=0;a<s.length;a++){var c=s[a],d=r(c,i.messages);d&&i.mechanisms.push(d)}}catch(u){console.error(u)}if(i.mechanisms.length>0){var h=e.find(i.mechanisms,function(e){return"redirect"===e.type}),p=e.find(i.mechanisms,function(e){return"all"===e.type});p||h||i.messages.push({type:"warning",message:'SPF strings should always either use an "all" mechanism or a "redirect" modifier to explicitly terminate processing.'});var m=-1;i.mechanisms.forEach(function(e,t){"all"===e.type&&-1===m&&(m=t)}),m>-1&&m<i.mechanisms.length-1&&i.messages.push({type:"warning",message:'One or more mechanisms were found after the "all" mechanism. These mechanisms will be ignored'}),h&&p&&i.messages.push({type:"warning",message:'The "redirect" modifier will not be used, because the SPF string contains an "all" mechanism. A "redirect" modifier is only used after all mechanisms fail to match, but "all" will always match'})}return!Object.keys(i.messages).length>0&&delete i.messages,i.valid=!0,i}var o=function(e,t){this.name="MechanismError",this.message=e,this.type=t||"warning",this.stack=(new Error).stack};o.prototype=Object.create(Error.prototype),o.prototype.constructor=o;var a={version:{description:"The SPF record version",pattern:/^v=(.+)$/i,validate:function(e){var t=e.match(this.pattern)[1];return t}},all:{description:"Always matches. It goes at the end of your record",pattern:/^all$/i},ip4:{description:"Match if IP is in the given range",pattern:/^ip4:(([\d.]*)(\/\d+)?)$/i,validate:function(e){var t=e.match(this.pattern),i=t[1];if(!i)throw new o("Missing or blank mandatory network specification for the 'ip4' mechanism.","error");return i}},ip6:{description:"Match if IPv6 is in the given range",pattern:/^ip6:((.*?)(\/\d+)?)$/i,validate:function(e){var t=e.match(this.pattern),i=t[1];if(!i)throw new o("Missing or blank mandatory network specification for the 'ip6' mechanism.","error");return i}},a:{description:"Match if IP has a DNS 'A' record in given domain",pattern:/a((:.*?)?(\/\d*)?)?$/i,validate:function(e){return t("a",this.pattern,e)}},mx:{description:"",pattern:/mx((:.*?)?(\/\d*)?)?$/i,validate:function(e){return t("mx",this.pattern,e)}},ptr:{description:"Match if IP has a DNS 'PTR' record within given domain",pattern:/^ptr(:.*?)?$/i,validate:function(e){return i("ptr",this.pattern,e)}},exists:{pattern:/^exists(:.*?)?$/i,validate:function(e){return s("exists",this.pattern,e)}},include:{description:"The specified domain is searched for an 'allow'",pattern:/^include(:.*?)?$/i,validate:function(e){return s("include",this.pattern,e)}},redirect:{description:"The SPF record for the value replaces the current record",pattern:/redirect(=.*?)?$/i,validate:function(e){return s("redirect",this.pattern,e)}},exp:{description:"Explanation message to send with rejection",pattern:/exp(=.*?)?$/i,validate:function(e){return s("exp",this.pattern,e)}}},c={"+":"Pass","-":"Fail","~":"SoftFail","?":"Neutral"},l=/^v=spf1/i,d=/(\+|-|~|\?)?(.+)/i;return{parse:n,parseTerm:r,mechanisms:a,prefixes:c}}),define("shared/js/email_deliverability/services/SPFRecordProcessor",["shared/js/email_deliverability/services/spfParser"],function(e){"use strict";function t(){function t(){return{module:"EmailAuth",func:"validate_current_spfs"}}function i(){return{module:"EmailAuth",func:"install_spf_records"}}function s(e){var t=[];return e&&(t=e.records.map(this.parseRecord.bind(this))),t}function r(e){var t=[];return e.forEach(function(e){t.push(this.processResultItem(e))},this),t}function n(e){var t=e.current.name,i=e.current.value,s=this._parseSPF(i);return s.state=e.state,s.recordType="spf",s.current={name:t,value:i},s=this.validateState(s)}function o(e){switch(e.valid=!1,e.state){case"SOFTFAIL":case"PERMERROR":break;case"PASS":case"VALID":e.valid=!0}return e}function a(e){return e.data.forEach(function(e){var t=e.domain;e.records.forEach(function(e){e.current={name:t+".",value:e.current}})}),e}function c(e,t){e=e||"";var i=this._parseSPF(e),s=[];t.forEach(function(e){i.mechanisms.forEach(function(t,i){t.type===e.type&&t.value===e.value&&s.push(i)})}),s=s.sort().reverse(),s.forEach(function(e){i.mechanisms.splice(e,1)});for(var r=[],n=0;i.mechanisms[n]&&i.mechanisms[n].type&&i.mechanisms[n].type.match(/^(version|ip|mx|a)$/);)r.push(i.mechanisms[n]),n++;for(t.forEach(function(e){r.push(e)});n<i.mechanisms.length;)r.push(i.mechanisms[n]),n++;var o=r.map(function(e){var t;return"version"===e.type?t=e.prefix+"="+e.value:(t=e.prefix+e.type,e.value&&(t+=":"+e.value)),t}).join(" ");return o}function l(e){var t=e.expected||"",i=t.split(/\s+/).map(this._parseSPFTerm),s="";if(e.records.length){var r=e.records[0].current;s=this.combineRecords(r.value,i)}else s=this.combineRecords("v=spf1 +mx +a ~all",i);return{name:e.domain+".",value:s,originalExpected:e.expected}}this.generateSuggestedRecord=l.bind(this),this.normalizeResults=a.bind(this),this.getValidateAPI=t.bind(this),this.getInstallAPI=i.bind(this),this.processResultItem=s.bind(this),this.processResultItems=r.bind(this),this.parseRecord=n.bind(this),this.validateState=o.bind(this),this._parseSPF=e.parse.bind(e),this._parseSPFTerm=e.parseTerm.bind(e),this.combineRecords=c.bind(this)}return new t}),define("shared/js/email_deliverability/services/PTRRecordProcessor",[],function(){"use strict";function e(){function e(){return{module:"EmailAuth",func:"validate_current_ptrs"}}function t(){throw new Error("ptr does not do install in this interface")}function i(e){var t=[];return e&&(t=e.records.map(this.parseRecord.bind(this))),t}function s(e){var t=[];return e.forEach(function(e){t.push(this.processResultItem(e))},this),t}function r(e){return e.recordType="ptr",this.validateState(e)}function n(e){switch(e.valid=!1,e.state){case"PASS":case"VALID":e.valid=!0}return e}function o(e){var t=e.data.map(function(e){var t=e.domain,i=e.ptr_records.map(function(i){return{current:{name:e.arpa_domain+".",value:i.domain},domain:t,state:i.state}});return{expected:e.arpa_domain,domain:t,records:i,details:e}});return{data:t}}function a(e){var t=e.expected;return{name:t+".",value:"unknown"}}this.generateSuggestedRecord=a.bind(this),this.normalizeResults=o.bind(this),this.getValidateAPI=e.bind(this),this.getInstallAPI=t.bind(this),this.processResultItem=i.bind(this),this.processResultItems=s.bind(this),this.parseRecord=r.bind(this),this.validateState=n.bind(this)}return new e}),define("shared/js/email_deliverability/services/domains",["angular","lodash","cjt/util/locale","shared/js/email_deliverability/services/domainFactory","shared/js/email_deliverability/services/DKIMRecordProcessor","shared/js/email_deliverability/services/SPFRecordProcessor","shared/js/email_deliverability/services/PTRRecordProcessor","cjt/modules","cjt/services/alertService","cjt/modules","cjt/services/APICatcher"],function(e,t,i,s,r,n,o){"use strict";function a(e){return e.replace(/^.+\._domainkey\./,"")}var c="shared.emailDeliverability.services.domains",l="DomainsService",d=["cjt2.services.apicatcher","cjt2.services.alert"],u=["$q","$log","$interval","alertService","APIInitializer","APICatcher","DOMAIN_TYPE_CONSTANTS","PAGE"],h=function(e){this.zone=e,this.domains=[],this.lockDomain=null};h.prototype.addDomain=function(e){this.domains.push(e)},h.prototype.getLockDomain=function(){return this.lockDomain},h.prototype.lock=function(e){if("object"!=typeof e)throw new Error("Give a domain object!");if(this.lockDomain)throw new Error("Zone "+this.zone+" cannot lock for "+e.domain+" because the zone is already locked for "+this.lockDomain+"!");this.lockDomain=e},h.prototype.unlock=function(){this.lockDomain=null};var p=function(e,c,l,d,u,p,m,f){function _(e){var s=e.data.filter(function(e){return"set"===e.validity_cache_update});if(s.length){var r=s.map(function(e){return t.escape(a(e.domain))});r=t.sortBy(r,function(e){return e.length}),d.add({type:"info",replace:!1,message:i.maketext("The system detected [quant,_1,domain,domains] whose [output,acronym,DKIM,DomainKeys Identified Mail] signatures were inactive despite valid [asis,DKIM] configuration. The system has automatically enabled [asis,DKIM] signatures for the following [numerate,_1,domain,domains]: [list_and_quoted,_2]",r.length,r)})}}var g,v={},y={},b=[],D=function(){};return D.prototype=Object.create(p),D.prototype._cacheDomain=function(e){return g||(g=[]),v[e.domain]=e,v["default._domainkey."+e.domain]=e,g.push(e),e},D.prototype._uncacheDomain=function(e){var t=this;if(!g)return!1;for(var i=t._getDomainObject(e),s=g.length-1;s>=0;s--)if(g[s].domain===i.domain)return g.splice(s,1),!0;return!1},D.prototype._getDomainObject=function(e){var t=this,i=e;return"string"==typeof i&&(i=t.findDomainByName(i)),i instanceof s.getClass()!=!0&&c.warn("Could not find domain “"+e+"”"),i},D.prototype.findDomainByName=function(e){return v[e]},D.prototype.getAll=function(){return g},D.prototype.fetchAll=function(){var t=this;if(t.getAll())return e.resolve(t.getAll());g=[];var i=f.domains||[];return i.forEach(function(e){if("*."!==e.substring(0,2)){var i=s.create({domain:e,type:e===f.mainDomain?m.MAIN:m.DOMAIN});t._cacheDomain(i)}}),e.resolve(t.getAll())},D.prototype._extractMailIPs=function(e){var t=e.data;t.forEach(function(e){var t=this._getDomainObject(e.domain);t&&t.setMailIP(e.ip_version,e.ip_address)},this)},D.prototype.findZoneByName=function(e){for(var t=0;t<b.length;t++)if(b[t].zone===e)return b[t];return null},D.prototype.findZoneByDomain=function(e){var t=this._getDomainObject(e);return v[t.domain]},D.prototype._addDomainToZone=function(e,t){var i=this.findZoneByName(t);i||(i=new h(t),b.push(i)),e.zone=t,i.addDomain(e),y[e.domain]=i},D.prototype._processNSAuthResultItem=function(e){var t=this._getDomainObject(e.domain);return t&&(t.hasNSAuthority="1"===e.local_authority.toString(),t.nameservers=e.nameservers,this._addDomainToZone(t,e.zone)),t},D.prototype._processRecordTypeResults=function(e,t,i){var s=e.normalizeResults(t);"ptr"===i&&this._extractMailIPs(t);var r=s.data,n=e.processResultItems(r);r.forEach(function(t,s){var r=this._getDomainObject(t.domain);if(!r)return void c.debug("domain not found",t);var o=n[s],a=e.generateSuggestedRecord(t);r.setSuggestedRecord(i,a),"ptr"===i?r.setRecordDetails(i,t.details):"spf"===i&&r.setExpectedMatch(i,t.expected),o.forEach(r.addRecord.bind(r))},this)},D.prototype._processMailRecordResults=function(e,t){var i=e.data,s=i.shift();s.data&&s.data.forEach(this._processNSAuthResultItem,this),t=t?t:this.getSupportedRecordTypes();var r=this.getRecordProcessors();t.forEach(function(e,t){var s=i[t],n=r[e];this._processRecordTypeResults(n,s,e),"dkim"===e&&_(s)},this)},D.prototype.fetchMailRecords=function(t,i){var s=this;if(0===t.length)return e.resolve();var r=new Date,n=r.getTime(),o=u.init("Batch","strict"),a={};t.forEach(function(e,t){return a["domain-"+t]=e.domain});var l=[];l.push(u.buildBatchCommandItem("DNS","has_local_authority",a)),i=i?i:this.getSupportedRecordTypes();var d=this.getRecordProcessors();return i.forEach(function(e){var t=d[e],i=t.getValidateAPI();l.push(u.buildBatchCommandItem(i.module,i.func,a))},this),o.addArgument("command",l),this._fetchMailRecordsPromise&&(c.debug("Canceling prior record status load"),this._fetchMailRecordsPromise.cancelCpCall()),this._fetchMailRecordsPromise=this.promise(o),this._fetchMailRecordsPromise.then(function(e){e=u.normalizeBatchResults(e);var r=new Date,o=r.getTime();c.debug("Updating record statuses load took "+(o-n)+"ms for "+t.length+" domains"),n=o,s._processMailRecordResults(e,i)}).finally(function(){delete s._fetchMailRecordsPromise;var e=new Date,i=e.getTime();c.debug("Updating record statuses parsing took "+(i-n)+"ms for "+t.length+" domains")})},D.prototype.validateAllRecords=function(e,t){var i=this;return t=t?t:i.getSupportedRecordTypes(),e=e.filter(function(e){return e.reloadingIn?!1:!0}),e.forEach(function(e){e.resetRecordLoaded()},i),i.fetchMailRecords(e,t).then(function(){e.forEach(function(e){e.setRecordsLoaded(t)},i)})},D.prototype.getRecordProcessors=function(){var e={dkim:r,spf:n};return void 0!==f.skipPTRLookups&&f.skipPTRLookups||(e.ptr=o),e},D.prototype.getSupportedRecordTypes=function(){return Object.keys(this.getRecordProcessors())},D.prototype.repairSPF=function(e,t){var i=this.getRecordProcessors(),s=i.spf,r=s.getInstallAPI(),n=e.map(function(e){return e.domain}),o=u.init(r.module,r.func);return o.addArgument("domain",n),o.addArgument("record",t),this.promise(o)},D.prototype.repairDKIM=function(e){var t=this.getRecordProcessors(),i=t.dkim,s=i.getInstallAPI(),r=e.map(function(e){return e.domain}),n=u.init(s.module,s.func);return n.addArgument("domain",r),this.promise(n)},D.prototype.repairPTR=function(){throw new Error("Installing PTR Records are not currently supported in this interface.")},D.prototype.repairRecord=function(e,t,i){return"spf"===t?this.repairSPF([e],[i]):"dkim"===t?this.repairDKIM([e],[i]):"ptr"===t?this.repairPTR([e],[i]):void 0},D.prototype._repairRecordSuccess=function(e,s,r){d.success({replace:!1,message:i.maketext("The system updated the “[_1]” record for “[_2]” to the following: [_3]",s.toUpperCase(),t.escape(e.domain),"<pre>"+t.escape(r)+"</pre>")})},D.prototype._repairRecordFailure=function(e,s,r){d.add({type:"error",replace:!1,message:i.maketext("The system failed to update the “[_1]” record for “[_2]” because of an error: [_3]",s.toUpperCase(),t.escape(e.domain),t.escape(r))})},D.prototype._interval=function(e,t,i){return l(e,t,i)},D.prototype._validateUntilSuccessComplete=function(e,t,s,r){var n=this;c.debug("["+e.domain+"] fetchMailRecords completed");var o=n.getSupportedRecordTypes();e.setRecordsLoaded(o);var a=t.some(function(t){return!e.isRecordValid(t)}),l=((new Date).getTime()-r)/1e3;return c.debug("["+e.domain+"] time passed since records set: "+l),a&&120>l?(c.debug("["+e.domain+"] some failed, wait "+s+"s, and then try again."),l>5&&d.add({type:"info",replace:!0,message:i.maketext("The server records have not updated after [quant,_1,second,seconds]. The system will try again in [quant,_2,second,seconds].",Math.floor(l),Math.floor(s))}),e.resetRecordLoaded(),e.reloadingIn=s,n._interval(function(){e.reloadingIn--},1e3,s).then(function(){return e.reloadingIn=0,s*=2,c.debug("["+e.domain+"] done waiting, trying again."),n.validateUntilSuccess(e,t,s,r)})):(a?l>120&&(c.debug("["+e.domain+"] more than 120s was taken to validate the change."),d.add({type:"warning",replace:!0,message:i.maketext("The system cannot verify that the record updated after 120 seconds.")})):(c.debug("["+e.domain+"] all records fixed."),d.success({replace:!0,message:i.maketext("The system successfully updated the [asis,DNS] records.")})),void e.setRecordsLoaded(n.getSupportedRecordTypes()))},D.prototype.validateUntilSuccess=function(e,t,i,s){var r=this,n=this._getDomainObject(e),o=r.getSupportedRecordTypes();return c.debug("["+e.domain+"] begin validateUntilSuccess @"+i+"s"),r.fetchMailRecords([n],o).then(function(){return r._validateUntilSuccessComplete(n,t,i,s)})},D.prototype.getDomainZoneObject=function(e){var t=this._getDomainObject(e);return this.findZoneByName(t.zone)||!1},D.prototype._repairDomainComplete=function(e,t,i,s){e=u.normalizeBatchResults(e),c.debug("["+t.domain+"] beginning _repairDomainComplete.");var r=this;if(e.data){var n=[];if(e.data.forEach(function(e,r){var o=i[r],a=s[r],c=e.data[0];"1"!==c.status.toString()?this._repairRecordFailure(t,o,c.msg):(n.push(o),this._repairRecordSuccess(t,o,a))},this),n.length){c.debug("["+t.domain+"] some records succeeeded.",n.join(","));var o=(new Date).getTime();return r.validateUntilSuccess(t,n,5,o)}return r.validateAllRecords([t])}},D.prototype.repairDomain=function(e,t,i){t=t.slice(),i=i.slice();var s=this,r=this._getDomainObject(e),n=this.findZoneByName(r.zone);n.lock(r),c.debug("["+r.domain+"] locking zone: ",n.zone),c.debug("["+r.domain+"] beginning repairDomain."),r.resetRecordLoaded(),c.debug("["+r.domain+"] resetting loaded records.");var o=u.init("Batch","strict"),a=s.getRecordProcessors(),l=t.map(function(e,t){var s=i[t],n=a[e],o=n.getInstallAPI();return c.debug("["+r.domain+"] adding batch command for “"+e+"”."),u.buildBatchCommandItem(o.module,o.func,{domain:r.domain,record:s})});return o.addArgument("command",l),s.promise(o).then(function(e){return c.debug("["+r.domain+"] batch command completed."),n.unlock(),s._repairDomainComplete(e,r,t,i)})},D.prototype._processGetPrivateDKIMKey=function(e){return e.data.pop()},D.prototype.fetchPrivateDKIMKey=function(e){var t=this._getDomainObject(e),i=u.init("EmailAuth","fetch_dkim_private_keys");return i.addArgument("domain",t.domain),this.promise(i).then(this._processGetPrivateDKIMKey)},D.prototype.getCurrentRecord=function(e,t){var i=this._getDomainObject(e);return i.getCurrentRecord(t)},D.prototype.getNoAuthorityMessage=function(e,s){var r=e.nameservers.map(t.escape);return e.nameservers.length?i.maketext("This system does not control [asis,DNS] for the “[_4]” domain. Contact the person responsible for the [list_and_quoted,_3] [numerate,_2,nameserver,nameservers] and request that they update the “[_1]” record with the following:",s.toUpperCase(),e.nameservers.length,r,e.domain):i.maketext("This system does not control [asis,DNS] for the “[_1]” domain, and the system did not find any authoritative nameservers for this domain. Contact your domain registrar to verify this domain’s registration.",e.domain)},D.prototype.fetchMailHeloIP=function(e){var t=this._getDomainObject(e),i=u.init("EmailAuth","get_mail_helo_ip");return i.addArgument("domain",t.domain),this.promise(i).then(this._processMailHeloResult)},D.prototype.localDKIMExists=function(e){var t="dkim";if(e.isRecordValid(t))return!0;var i=e.getSuggestedRecord(t);return i.value?!0:!1},D.prototype.ensureLocalDKIMKeyExists=function(e){var i=this,s=u.init("EmailAuth","ensure_dkim_keys_exist");return s.addArgument("domain",e.domain),i.promise(s).then(function(s){var r=s.data,n=r.pop();return"1"===n.status.toString()?i.fetchMailRecords([e]):d.add({type:"error",message:t.escape(n.msg)})})},D.prototype.markViewLoad=function(){this._fetchMailRecordsPromise&&this._fetchMailRecordsPromise.cancelCpCall()},new D};u.push(p);var m=e.module(c,d);return m.value("PAGE",PAGE),m.value("DOMAIN_TYPE_CONSTANTS",s.getTypeConstants()),m.factory(l,u),{"class":p,namespace:c}}),define("shared/js/email_deliverability/filters/htmlSafeString",["angular","lodash"],function(e,t){"use strict";var i="shared.emailDeliverability.htmlSafeString.filter",s=[],r=[],n=function(){return t.escape},o=e.module(i,s);return o.filter("htmlSafeString",r.concat(n)),{"class":n,namespace:i}}),define("app/decorators/paginationDecorator",["angular","cjt/core","cjt/util/locale","uiBootstrap"],function(e,t,i){"use strict";var s,r="cpanel.emailAccounts";try{s=e.module(r)}catch(n){s=e.module(r,["ui.bootstrap.pagination"])}return s.config(["$provide",function(e){e.decorator("uibPaginationDirective",["$delegate",function(e){var s="decorators/pagination.phtml",r="email_accounts/"+s,n=e[0],o=function(e,t){e&&e.forEach(function(e){e.id=t+"_"+e.text})},a=function(e){e&&e.forEach(function(e){e.ariaLabel=i.maketext("Go to page “[_1]”.",e.text)})},c=function(e,t){return i.maketext("Page [numf,_1] of [numf,_2]",e,t)};n.templateUrl=t.config.debug?t.buildFullPath(r):s;var l=n.link;return n.compile=function(){return function(e,t,s,r){var n=r[0];l.apply(this,arguments),e.parentId=s.id,e.ariaLabels={title:i.maketext("Pagination"),firstPage:i.maketext("Go to first page."),previousPage:i.maketext("Go to previous page."),nextPage:i.maketext("Go to next page."),lastPage:i.maketext("Go to last page.")},e.updateCurrentSelectedText=c;var d=n.render;n.render=function(){d.apply(n),o(e.pages,e.parentId),a(e.pages)}}},e}])}]),{namespace:r}}),function(e){define("jquery-chosen",["jquery"],function(){return function(){(function(){var e,t,i,s,r,n={}.hasOwnProperty,o=function(e,t){function i(){this.constructor=e}for(var s in t)n.call(t,s)&&(e[s]=t[s]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};s=function(){function e(){this.options_index=0,this.parsed=[]}return e.prototype.add_node=function(e){return"OPTGROUP"===e.nodeName.toUpperCase()?this.add_group(e):this.add_option(e)},e.prototype.add_group=function(e){var t,i,s,r,n,o;for(t=this.parsed.length,this.parsed.push({array_index:t,group:!0,label:this.escapeExpression(e.label),title:e.title?e.title:void 0,children:0,disabled:e.disabled,classes:e.className}),n=e.childNodes,o=[],s=0,r=n.length;r>s;s++)i=n[s],o.push(this.add_option(i,t,e.disabled));return o},e.prototype.add_option=function(e,t,i){return"OPTION"===e.nodeName.toUpperCase()?(""!==e.text?(null!=t&&(this.parsed[t].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:e.value,text:e.text,html:e.innerHTML,title:e.title?e.title:void 0,selected:e.selected,disabled:i===!0?i:e.disabled,group_array_index:t,group_label:null!=t?this.parsed[t].label:null,classes:e.className,style:e.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},e.prototype.escapeExpression=function(e){var t,i;return null==e||e===!1?"":/[\&\<\>\"\'\`]/.test(e)?(t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=/&(?!\w+;)|[\<\>\"\'\`]/g,e.replace(i,function(e){return t[e]||"&amp;"})):e},e}(),s.select_to_array=function(e){var t,i,r,n,o;for(i=new s,o=e.childNodes,r=0,n=o.length;n>r;r++)t=o[r],i.add_node(t);return i.parsed},t=function(){function e(t,i){this.form_field=t,this.options=null!=i?i:{},e.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers(),this.on_ready())}return e.prototype.set_default_values=function(){var e=this;return this.click_test_action=function(t){return e.test_active_click(t)},this.activate_action=function(t){return e.activate_field(t)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null!=this.options.enable_split_word_search?this.options.enable_split_word_search:!0,this.group_search=null!=this.options.group_search?this.options.group_search:!0,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=null!=this.options.single_backstroke_delete?this.options.single_backstroke_delete:!0,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.display_selected_options=null!=this.options.display_selected_options?this.options.display_selected_options:!0,this.display_disabled_options=null!=this.options.display_disabled_options?this.options.display_disabled_options:!0,this.include_group_label_in_selected=this.options.include_group_label_in_selected||!1,this.max_shown_results=this.options.max_shown_results||Number.POSITIVE_INFINITY
},e.prototype.set_default_text=function(){return this.default_text=this.form_field.getAttribute("data-placeholder")?this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||e.default_multiple_text:this.options.placeholder_text_single||this.options.placeholder_text||e.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||e.default_no_result_text},e.prototype.choice_label=function(e){return this.include_group_label_in_selected&&null!=e.group_label?"<b class='group-name'>"+e.group_label+"</b>"+e.html:e.html},e.prototype.mouse_enter=function(){return this.mouse_on_container=!0},e.prototype.mouse_leave=function(){return this.mouse_on_container=!1},e.prototype.input_focus=function(){var e=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return e.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},e.prototype.input_blur=function(){var e=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return e.blur_test()},100))},e.prototype.results_option_build=function(e){var t,i,s,r,n,o,a;for(t="",r=0,a=this.results_data,n=0,o=a.length;o>n&&(i=a[n],s="",s=i.group?this.result_add_group(i):this.result_add_option(i),""!==s&&(r++,t+=s),(null!=e?e.first:void 0)&&(i.selected&&this.is_multiple?this.choice_build(i):i.selected&&!this.is_multiple&&this.single_set_selected_text(this.choice_label(i))),!(r>=this.max_shown_results));n++);return t},e.prototype.result_add_option=function(e){var t,i;return e.search_match&&this.include_option_in_results(e)?(t=[],e.disabled||e.selected&&this.is_multiple||t.push("active-result"),!e.disabled||e.selected&&this.is_multiple||t.push("disabled-result"),e.selected&&t.push("result-selected"),null!=e.group_array_index&&t.push("group-option"),""!==e.classes&&t.push(e.classes),i=document.createElement("li"),i.className=t.join(" "),i.style.cssText=e.style,i.setAttribute("data-option-array-index",e.array_index),i.innerHTML=e.search_text,e.title&&(i.title=e.title),this.outerHTML(i)):""},e.prototype.result_add_group=function(e){var t,i;return(e.search_match||e.group_match)&&e.active_options>0?(t=[],t.push("group-result"),e.classes&&t.push(e.classes),i=document.createElement("li"),i.className=t.join(" "),i.innerHTML=e.search_text,e.title&&(i.title=e.title),this.outerHTML(i)):""},e.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.results_build(),this.results_showing?this.winnow_results():void 0},e.prototype.reset_single_select_options=function(){var e,t,i,s,r;for(s=this.results_data,r=[],t=0,i=s.length;i>t;t++)e=s[t],r.push(e.selected?e.selected=!1:void 0);return r},e.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},e.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()},e.prototype.winnow_results=function(){var e,t,i,s,r,n,o,a,c,l,d,u;for(this.no_results_clear(),s=0,n=this.get_search_text(),e=n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),c=new RegExp(e,"i"),i=this.get_search_regex(e),u=this.results_data,l=0,d=u.length;d>l;l++)t=u[l],t.search_match=!1,r=null,this.include_option_in_results(t)&&(t.group&&(t.group_match=!1,t.active_options=0),null!=t.group_array_index&&this.results_data[t.group_array_index]&&(r=this.results_data[t.group_array_index],0===r.active_options&&r.search_match&&(s+=1),r.active_options+=1),t.search_text=t.group?t.label:t.html,(!t.group||this.group_search)&&(t.search_match=this.search_string_match(t.search_text,i),t.search_match&&!t.group&&(s+=1),t.search_match?(n.length&&(o=t.search_text.search(c),a=t.search_text.substr(0,o+n.length)+"</em>"+t.search_text.substr(o+n.length),t.search_text=a.substr(0,o)+"<em>"+a.substr(o)),null!=r&&(r.group_match=!0)):null!=t.group_array_index&&this.results_data[t.group_array_index].search_match&&(t.search_match=!0)));return this.result_clear_highlight(),1>s&&n.length?(this.update_results_content(""),this.no_results(n)):(this.update_results_content(this.results_option_build()),this.winnow_results_set_highlight())},e.prototype.get_search_regex=function(e){var t;return t=this.search_contains?"":"^",new RegExp(t+e,"i")},e.prototype.search_string_match=function(e,t){var i,s,r,n;if(t.test(e))return!0;if(this.enable_split_word_search&&(e.indexOf(" ")>=0||0===e.indexOf("["))&&(s=e.replace(/\[|\]/g,"").split(" "),s.length))for(r=0,n=s.length;n>r;r++)if(i=s[r],t.test(i))return!0},e.prototype.choices_count=function(){var e,t,i,s;if(null!=this.selected_option_count)return this.selected_option_count;for(this.selected_option_count=0,s=this.form_field.options,t=0,i=s.length;i>t;t++)e=s[t],e.selected&&(this.selected_option_count+=1);return this.selected_option_count},e.prototype.choices_click=function(e){return e.preventDefault(),this.results_showing||this.is_disabled?void 0:this.results_show()},e.prototype.keyup_checker=function(e){var t,i;switch(t=null!=(i=e.which)?i:e.keyCode,this.search_field_scale(),t){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(e.preventDefault(),this.results_showing)return this.result_select(e);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:case 18:break;default:return this.results_search()}},e.prototype.clipboard_event_checker=function(){var e=this;return setTimeout(function(){return e.results_search()},50)},e.prototype.container_width=function(){return null!=this.options.width?this.options.width:""+this.form_field.offsetWidth+"px"},e.prototype.include_option_in_results=function(e){return this.is_multiple&&!this.display_selected_options&&e.selected?!1:!this.display_disabled_options&&e.disabled?!1:e.empty?!1:!0},e.prototype.search_results_touchstart=function(e){return this.touch_started=!0,this.search_results_mouseover(e)},e.prototype.search_results_touchmove=function(e){return this.touch_started=!1,this.search_results_mouseout(e)},e.prototype.search_results_touchend=function(e){return this.touch_started?this.search_results_mouseup(e):void 0},e.prototype.outerHTML=function(e){var t;return e.outerHTML?e.outerHTML:(t=document.createElement("div"),t.appendChild(e),t.innerHTML)},e.browser_is_supported=function(){return/iP(od|hone)/i.test(window.navigator.userAgent)?!1:/Android/i.test(window.navigator.userAgent)&&/Mobile/i.test(window.navigator.userAgent)?!1:/IEMobile/i.test(window.navigator.userAgent)?!1:/Windows Phone/i.test(window.navigator.userAgent)?!1:/BlackBerry/i.test(window.navigator.userAgent)?!1:/BB10/i.test(window.navigator.userAgent)?!1:"Microsoft Internet Explorer"===window.navigator.appName?document.documentMode>=8:!0},e.default_multiple_text="Select Some Options",e.default_single_text="Select an Option",e.default_no_result_text="No results match",e}(),e=jQuery,e.fn.extend({chosen:function(s){return t.browser_is_supported()?this.each(function(){var t,r;return t=e(this),r=t.data("chosen"),"destroy"===s?void(r instanceof i&&r.destroy()):void(r instanceof i||t.data("chosen",new i(this,s)))}):this}}),i=function(t){function i(){return r=i.__super__.constructor.apply(this,arguments)}return o(i,t),i.prototype.setup=function(){return this.form_field_jq=e(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field_jq.hasClass("chosen-rtl")},i.prototype.set_up_html=function(){var t,i;return t=["chosen-container"],t.push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&t.push(this.form_field.className),this.is_rtl&&t.push("chosen-rtl"),i={"class":t.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.form_field.id.length&&(i.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=e("<div />",i),this.container.html(this.is_multiple?'<ul class="chosen-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>':'<a class="chosen-single chosen-default"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>'),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chosen-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chosen-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chosen-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chosen-search").first(),this.selected_item=this.container.find(".chosen-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior()},i.prototype.on_ready=function(){return this.form_field_jq.trigger("chosen:ready",{chosen:this})},i.prototype.register_observers=function(){var e=this;return this.container.bind("touchstart.chosen",function(t){return e.container_mousedown(t),t.preventDefault()}),this.container.bind("touchend.chosen",function(t){return e.container_mouseup(t),t.preventDefault()}),this.container.bind("mousedown.chosen",function(t){e.container_mousedown(t)}),this.container.bind("mouseup.chosen",function(t){e.container_mouseup(t)}),this.container.bind("mouseenter.chosen",function(t){e.mouse_enter(t)}),this.container.bind("mouseleave.chosen",function(t){e.mouse_leave(t)}),this.search_results.bind("mouseup.chosen",function(t){e.search_results_mouseup(t)}),this.search_results.bind("mouseover.chosen",function(t){e.search_results_mouseover(t)}),this.search_results.bind("mouseout.chosen",function(t){e.search_results_mouseout(t)}),this.search_results.bind("mousewheel.chosen DOMMouseScroll.chosen",function(t){e.search_results_mousewheel(t)}),this.search_results.bind("touchstart.chosen",function(t){e.search_results_touchstart(t)}),this.search_results.bind("touchmove.chosen",function(t){e.search_results_touchmove(t)}),this.search_results.bind("touchend.chosen",function(t){e.search_results_touchend(t)}),this.form_field_jq.bind("chosen:updated.chosen",function(t){e.results_update_field(t)}),this.form_field_jq.bind("chosen:activate.chosen",function(t){e.activate_field(t)}),this.form_field_jq.bind("chosen:open.chosen",function(t){e.container_mousedown(t)}),this.form_field_jq.bind("chosen:close.chosen",function(t){e.input_blur(t)}),this.search_field.bind("blur.chosen",function(t){e.input_blur(t)}),this.search_field.bind("keyup.chosen",function(t){e.keyup_checker(t)}),this.search_field.bind("keydown.chosen",function(t){e.keydown_checker(t)}),this.search_field.bind("focus.chosen",function(t){e.input_focus(t)}),this.search_field.bind("cut.chosen",function(t){e.clipboard_event_checker(t)}),this.search_field.bind("paste.chosen",function(t){e.clipboard_event_checker(t)}),this.is_multiple?this.search_choices.bind("click.chosen",function(t){e.choices_click(t)}):this.container.bind("click.chosen",function(e){e.preventDefault()})},i.prototype.destroy=function(){return e(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action),this.search_field[0].tabIndex&&(this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex),this.container.remove(),this.form_field_jq.removeData("chosen"),this.form_field_jq.show()},i.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chosen-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus.chosen",this.activate_action),this.close_field()):(this.container.removeClass("chosen-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus.chosen",this.activate_action))},i.prototype.container_mousedown=function(t){return this.is_disabled||(t&&"mousedown"===t.type&&!this.results_showing&&t.preventDefault(),null!=t&&e(t.target).hasClass("search-choice-close"))?void 0:(this.active_field?this.is_multiple||!t||e(t.target)[0]!==this.selected_item[0]&&!e(t.target).parents("a.chosen-single").length||(t.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),e(this.container[0].ownerDocument).bind("click.chosen",this.click_test_action),this.results_show()),this.activate_field())},i.prototype.container_mouseup=function(e){return"ABBR"!==e.target.nodeName||this.is_disabled?void 0:this.results_reset(e)},i.prototype.search_results_mousewheel=function(e){var t;return e.originalEvent&&(t=e.originalEvent.deltaY||-e.originalEvent.wheelDelta||e.originalEvent.detail),null!=t?(e.preventDefault(),"DOMMouseScroll"===e.type&&(t=40*t),this.search_results.scrollTop(t+this.search_results.scrollTop())):void 0},i.prototype.blur_test=function(){return!this.active_field&&this.container.hasClass("chosen-container-active")?this.close_field():void 0},i.prototype.close_field=function(){return e(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chosen-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},i.prototype.activate_field=function(){return this.container.addClass("chosen-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},i.prototype.test_active_click=function(t){var i;return i=e(t.target).closest(".chosen-container"),i.length&&this.container[0]===i[0]?this.active_field=!0:this.close_field()},i.prototype.results_build=function(){return this.parsing=!0,this.selected_option_count=null,this.results_data=s.select_to_array(this.form_field),this.is_multiple?this.search_choices.find("li.search-choice").remove():this.is_multiple||(this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field[0].readOnly=!0,this.container.addClass("chosen-container-single-nosearch")):(this.search_field[0].readOnly=!1,this.container.removeClass("chosen-container-single-nosearch"))),this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1},i.prototype.result_do_highlight=function(e){var t,i,s,r,n;if(e.length){if(this.result_clear_highlight(),this.result_highlight=e,this.result_highlight.addClass("highlighted"),s=parseInt(this.search_results.css("maxHeight"),10),n=this.search_results.scrollTop(),r=s+n,i=this.result_highlight.position().top+this.search_results.scrollTop(),t=i+this.result_highlight.outerHeight(),t>=r)return this.search_results.scrollTop(t-s>0?t-s:0);if(n>i)return this.search_results.scrollTop(i)}},i.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},i.prototype.results_show=function(){return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.container.addClass("chosen-with-drop"),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results(),this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this}))},i.prototype.update_results_content=function(e){return this.search_results.html(e)},i.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),this.container.removeClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})),this.results_showing=!1},i.prototype.set_tab_index=function(){var e;return this.form_field.tabIndex?(e=this.form_field.tabIndex,this.form_field.tabIndex=-1,this.search_field[0].tabIndex=e):void 0},i.prototype.set_label_behavior=function(){var t=this;return this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=e("label[for='"+this.form_field.id+"']")),this.form_field_label.length>0?this.form_field_label.bind("click.chosen",function(e){return t.is_multiple?t.container_mousedown(e):t.activate_field()}):void 0},i.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},i.prototype.search_results_mouseup=function(t){var i;return i=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),i.length?(this.result_highlight=i,this.result_select(t),this.search_field.focus()):void 0},i.prototype.search_results_mouseover=function(t){var i;return i=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),i?this.result_do_highlight(i):void 0},i.prototype.search_results_mouseout=function(t){return e(t.target).hasClass("active-result")?this.result_clear_highlight():void 0},i.prototype.choice_build=function(t){var i,s,r=this;return i=e("<li />",{"class":"search-choice"}).html("<span>"+this.choice_label(t)+"</span>"),t.disabled?i.addClass("search-choice-disabled"):(s=e("<a />",{"class":"search-choice-close","data-option-array-index":t.array_index}),s.bind("click.chosen",function(e){return r.choice_destroy_link_click(e)}),i.append(s)),this.search_container.before(i)},i.prototype.choice_destroy_link_click=function(t){return t.preventDefault(),t.stopPropagation(),this.is_disabled?void 0:this.choice_destroy(e(t.target))},i.prototype.choice_destroy=function(e){return this.result_deselect(e[0].getAttribute("data-option-array-index"))?(this.show_search_field_default(),this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1&&this.results_hide(),e.parents("li").first().remove(),this.search_field_scale()):void 0},i.prototype.results_reset=function(){return this.reset_single_select_options(),this.form_field.options[0].selected=!0,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},i.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},i.prototype.result_select=function(e){var t,i;return this.result_highlight?(t=this.result_highlight,this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.is_multiple?t.removeClass("active-result"):this.reset_single_select_options(),t.addClass("result-selected"),i=this.results_data[t[0].getAttribute("data-option-array-index")],i.selected=!0,this.form_field.options[i.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(i):this.single_set_selected_text(this.choice_label(i)),(e.metaKey||e.ctrlKey)&&this.is_multiple||this.results_hide(),this.show_search_field_default(),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[i.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,e.preventDefault(),this.search_field_scale())):void 0},i.prototype.single_set_selected_text=function(e){return null==e&&(e=this.default_text),e===this.default_text?this.selected_item.addClass("chosen-default"):(this.single_deselect_control_build(),this.selected_item.removeClass("chosen-default")),this.selected_item.find("span").html(e)},i.prototype.result_deselect=function(e){var t;return t=this.results_data[e],this.form_field.options[t.options_index].disabled?!1:(t.selected=!1,this.form_field.options[t.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[t.options_index].value}),this.search_field_scale(),!0)},i.prototype.single_deselect_control_build=function(){return this.allow_single_deselect?(this.selected_item.find("abbr").length||this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'),this.selected_item.addClass("chosen-single-with-deselect")):void 0},i.prototype.get_search_text=function(){return e("<div/>").text(e.trim(this.search_field.val())).html()},i.prototype.winnow_results_set_highlight=function(){var e,t;return t=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),e=t.length?t.first():this.search_results.find(".active-result").first(),null!=e?this.result_do_highlight(e):void 0},i.prototype.no_results=function(t){var i;return i=e('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),i.find("span").first().html(t),this.search_results.append(i),this.form_field_jq.trigger("chosen:no_results",{chosen:this})},i.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},i.prototype.keydown_arrow=function(){var e;return this.results_showing&&this.result_highlight?(e=this.result_highlight.nextAll("li.active-result").first())?this.result_do_highlight(e):void 0:this.results_show()},i.prototype.keyup_arrow=function(){var e;return this.results_showing||this.is_multiple?this.result_highlight?(e=this.result_highlight.prevAll("li.active-result"),e.length?this.result_do_highlight(e.first()):(this.choices_count()>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},i.prototype.keydown_backstroke=function(){var e;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(e=this.search_container.siblings("li.search-choice").last(),e.length&&!e.hasClass("search-choice-disabled")?(this.pending_backstroke=e,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},i.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},i.prototype.keydown_checker=function(e){var t,i;switch(t=null!=(i=e.which)?i:e.keyCode,this.search_field_scale(),8!==t&&this.pending_backstroke&&this.clear_backstroke(),t){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(e),this.mouse_on_container=!1;break;case 13:this.results_showing&&e.preventDefault();break;case 32:this.disable_search&&e.preventDefault();break;case 38:e.preventDefault(),this.keyup_arrow();break;case 40:e.preventDefault(),this.keydown_arrow()}},i.prototype.search_field_scale=function(){var t,i,s,r,n,o,a,c,l;if(this.is_multiple){for(s=0,a=0,n="position:absolute; left: -1000px; top: -1000px; display:none;",o=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],c=0,l=o.length;l>c;c++)r=o[c],n+=r+":"+this.search_field.css(r)+";";return t=e("<div />",{style:n}),t.text(this.search_field.val()),e("body").append(t),a=t.width()+25,t.remove(),i=this.container.outerWidth(),a>i-10&&(a=i-10),this.search_field.css({width:a+"px"})}},i}(t)}).call(this)}.apply(e,arguments)})}(this),function(e){define("angular-chosen",["angular","jquery-chosen"],function(){return function(){(function(){var e=[].indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(t in this&&this[t]===e)return t;return-1};angular.module("localytics.directives",[]),angular.module("localytics.directives").directive("chosen",["$timeout",function(t){var i,s,r,n;return s=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,i=["persistentCreateOption","createOptionText","createOption","skipNoResults","noResultsText","allowSingleDeselect","disableSearchThreshold","disableSearch","enableSplitWordSearch","inheritSelectClasses","maxSelectedOptions","placeholderTextMultiple","placeholderTextSingle","searchContains","singleBackstrokeDelete","displayDisabledOptions","displaySelectedOptions","width","includeGroupLabelInSelected","maxShownResults"],n=function(e){return e.replace(/[A-Z]/g,function(e){return"_"+e.toLowerCase()})},r=function(e){var t;if(angular.isArray(e))return 0===e.length;if(angular.isObject(e))for(t in e)if(e.hasOwnProperty(t))return!1;return!0},{restrict:"A",require:"?ngModel",priority:1,link:function(o,a,c,l){var d,u,h,p,m,f,_,g,v,y,b;return o.disabledValuesHistory=o.disabledValuesHistory?o.disabledValuesHistory:[],a=$(a),a.addClass("localytics-chosen"),m=o.$eval(c.chosen)||{},angular.forEach(c,function(t,s){return e.call(i,s)>=0?c.$observe(s,function(e){return m[n(s)]="{{"===String(a.attr(c.$attr[s])).slice(0,2)?e:o.$eval(e),v()}):void 0}),_=function(){return a.addClass("loading").attr("disabled",!0).trigger("chosen:updated")},g=function(){return a.removeClass("loading"),angular.isDefined(c.disabled)?a.attr("disabled",c.disabled):a.attr("disabled",!1),a.trigger("chosen:updated")},d=null,u=!1,h=function(){var e;return d?a.trigger("chosen:updated"):(t(function(){d=a.chosen(m).data("chosen")}),angular.isObject(d)?e=d.default_text:void 0)},v=function(){return u?a.attr("data-placeholder",d.results_none_found).attr("disabled",!0):a.removeAttr("data-placeholder"),a.trigger("chosen:updated")},l?(f=l.$render,l.$render=function(){return f(),h()},a.on("chosen:hiding_dropdown",function(){return o.$apply(function(){return l.$setTouched()})}),c.multiple&&(b=function(){return l.$viewValue},o.$watch(b,l.$render,!0))):h(),c.$observe("disabled",function(){return a.trigger("chosen:updated")}),c.ngOptions&&l?(p=c.ngOptions.match(s),y=p[7],o.$watchCollection(y,function(e){var i;return i=t(function(){return angular.isUndefined(e)?_():(u=r(e),g(),v())})}),o.$on("$destroy",function(){return"undefined"!=typeof timer&&null!==timer?t.cancel(timer):void 0})):void 0}}}])}).call(this)}.apply(e,arguments)})}(this),define("shared/js/email_deliverability/directives/copyField",["angular","cjt/util/locale","cjt/core","cjt/modules","cjt/services/alertService"],function(e,t,i){"use strict";function s(e){var t=document.getElementById(e);return t.focus(),t.select(),document.execCommand("copy")}var r="shared/js/email_deliverability/directives/copyField.ptt",n=i.config.debug?i.buildFullPath(r):i.buildPath(r),o="shared.emailDeliverability.copyField.directive",a=["cjt2.services.alert"],c=["$scope","$timeout","alertService"],l=function(e,i,r){e._onSuccess=function(){r.success(t.maketext("Successfully copied to the clipboard.")),e.copying=!0,i(function(){e.copying=!1},3e3)},e._execCopy=function(){return s(e.copyFieldID)},e.copyToClipboard=function(){e._execCopy()&&e._onSuccess()},e.processText=function(){if(e.text){var t=e.text.split("\n");t.length>1&&(e.multilineRows=t.length-1)}},e.$watch("text",e.processText),e.processText()},d=e.module(o,a),u=function(e,i,s){e.multilineRows=1,e.copyFieldID=e.parentID+"_recordField",e.copying=!1,e.placeholderText=s.placeholder?s.placeholder:t.maketext("Nothing to copy")};return d.directive("copyField",function(){return{templateUrl:n,scope:{parentID:"@id",text:"=",label:"@"},restrict:"E",replace:!0,transclude:!0,link:u,controller:c.concat(l)}}),{"class":l,namespace:o,link:u,template:n,execCopyToClipboard:s}}),define("shared/js/email_deliverability/directives/suggestedRecordSet",["angular","lodash","shared/js/email_deliverability/directives/copyField","shared/js/email_deliverability/filters/htmlSafeString","cjt/util/locale","cjt/core","cjt/directives/callout","cjt/modules"],function(e,t,i,s,r,n){"use strict";var o="shared/js/email_deliverability/directives/suggestedRecordSet.ptt",a=n.config.debug?n.buildFullPath(o):n.buildPath(o),c="shared.emailDeliverability.suggestedRecordSet.directive",l=[i.namespace,s.namespace],d=new RegExp("(.{1,255})","g"),u=["$scope"],h=function(e){e.domainName=e.domain.domain,e._suggestionMode=function(){e.label=r.maketext("Suggested “[_1]” ([_2]) Record",e.recordType.toUpperCase(),e.recordZoneType),e.record=e.domain.getSuggestedRecord(e.recordType),e.noRecordMessage=r.maketext("Suggested “[_1]” does not exist.",e.recordType.toUpperCase()),e.nameText=e.record.name,e.originalValueText=e.valueText=e.record.value},e._currentMode=function(){e.label=r.maketext("Current “[_1]” ([_2]) Record",e.recordType.toUpperCase(),e.recordZoneType),e.record=e.domain.getCurrentRecord(e.recordType),e.noRecordMessage=r.maketext("Current “[_1]” does not exist.",e.recordType.toUpperCase()),e.nameText=e.record.name,e.originalValueText=e.valueText=e.record.value},e._recordsReady=function(){e.domain.recordsLoaded&&(e.recordValid=e.domain.isRecordValid(e.recordType),e.recordsLoaded=!0,e.alwaysCurrent?e._currentMode():e.alwaysSuggested?e._suggestionMode():e.recordValid?e._currentMode():e._suggestionMode(),0===Object.keys(e.record).length&&(e.record=!1))},e._checkRecordsReady=function(){return e.domain.recordsLoaded},e.splitMode="full",e.toggleSplitMode=function(){if(e.splitMode="full"===e.splitMode?"split":"full","split"===e.splitMode){if(!e.splitText){var i=e.originalValueText.match(d);e.splitText=t.join(t.map(i,function(e){return'"'+e+'"'})," ")}e.valueText=e.splitText}else e.valueText=e.originalValueText},e.$watch(e._checkRecordsReady,e._recordsReady),e.label=r.maketext("Loading “[_1]” Record",e.recordType.toUpperCase())},p=e.module(c,l),m=function(e,i,s){t.isUndefined(s.hideExtras)===!1&&(e.hideExtras=!0),t.isUndefined(s.alwaysSuggested)===!1&&(e.alwaysSuggested=!0),t.isUndefined(s.alwaysCurrent)===!1&&(e.alwaysCurrent=!0)};return p.directive("suggestedRecordSet",function(){return{templateUrl:a,scope:{parentID:"@id",domain:"=",recordType:"@",recordZoneType:"@",splitable:"="},restrict:"E",replace:!0,transclude:!0,link:m,controller:u.concat(h)}}),{"class":h,namespace:c,template:a}}),define("shared/js/email_deliverability/views/manageDomain",["angular","lodash","cjt/core","cjt/util/locale","cjt/util/inet6","shared/js/email_deliverability/services/domains","shared/js/email_deliverability/directives/copyField","shared/js/email_deliverability/directives/suggestedRecordSet","cjt/modules","cjt/directives/callout","cjt/directives/actionButtonDirective"],function(e,t,i,s,r,n,o,a){"use strict";var c="shared.emailDeliverability.views.manageDomain",l=[n.namespace,o.namespace,a.namespace],d="ManageDomainController",u=["$scope","$location","$routeParams","DomainsService","alertService","ADD_RESOURCE_PANEL","PAGE"],h=function(n,o,a,c,l,d,u){return n.canReturnToLister=!u.CAN_SKIP_LISTER||c.getAll().length>1,n._returnToLister=function(){o.path("/").search("")},n.init=function(){var t=c.getAll();if(n.currentDomain=c.findDomainByName(a.domain),n.skipPTRLookups=void 0!==u.skipPTRLookups?u.skipPTRLookups:!1,!n.currentDomain&&t.length>1)return l.add({message:s.maketext("You did not specify a domain to manage."),type:"info"}),void n._returnToLister();1===t.length&&(n.currentDomain=t[0]),e.extend(n,{isWhm:i.isWhm(),confirmDKIMDownloadRequest:!1,showConfirmDKIM:!1,dkimPrivateKey:!1,ptrServerName:"",resourcesPanelTemplate:d,isRecordValid:n.currentDomain.isRecordValid.bind(n.currentDomain),getSuggestedRecord:n.currentDomain.getSuggestedRecord.bind(n.currentDomain)});var r=c.validateAllRecords([n.currentDomain]);return n.skipPTRLookups||r.then(n._populatePTRInfo).then(n._handlePTRStatus),r
},n._populatePTRInfo=function(){var e=n.currentDomain.getRecordDetails("ptr"),t=n.currentDomain.getSuggestedRecord("ptr");t.value=e.helo+".",n.currentDomain.setSuggestedRecord("ptr",t),n.ptrServerName=e.helo,n.ptrServerIP=e.ip_address},n.hasNSAuthority=function(){return n.currentDomain.hasNSAuthority},n.badConfigurationMessage=function(e){var t=n.currentDomain.getRecords([e]);return t.length?s.maketext("“[_1]” is [output,strong,not] properly configured for this domain.",e.toUpperCase()):s.maketext("A “[_1]” record does [output,strong,not] exist for this domain.",e.toUpperCase())},n.noAuthorityMessage=function(e){return c.getNoAuthorityMessage(n.currentDomain,e)},n.validRecordMessage=function(e){return s.maketext("“[_1]” is properly configured for this domain.",e.toUpperCase())},n.repairRecord=function(e){var t=n.getSuggestedRecord(e),i=c.repairDomain(n.currentDomain,[e],[t.value]);return n.skipPTRLookups||i.then(n._populatePTRInfo),i.finally(function(){n.showConfirmDKIM=!1}),i},n.toggleShowConfirmDKIM=function(){n.showConfirmDKIM=!n.showConfirmDKIM},n.getCurrentRecord=function(e){return c.getCurrentRecord(n.currentDomain,e)},n._handlePTRStatus=function(){var e=n.currentDomain.getRecordDetails("ptr"),o=e.state,a=e.ptr_records,c=e.ip_address,l=e.helo,d=e.arpa_domain;if(n.ptrStatusCode=o,"IP_IS_PRIVATE"===o)n.ipIsPrivate=!0;else{var u=n.getSuggestedRecord("ptr").name;u=u.replace(/\.$/,""),n.ptrRecordName=t.escape(u);var h=e.nameservers.map(t.escape)||[];if(h.sort(),"MISSING_PTR"===o&&(n.badPTRMessages=[s.maketext("There is no reverse [asis,DNS] configured for the [asis,IP] address ([_1]) that the system uses to send this domain’s outgoing email.",c)],n.ptrToFixMessage=i.isWhm()?h.length?s.maketext("To fix this problem, create the following [asis,PTR] record at [list_and_quoted,_1]:",h):s.maketext("To fix this problem, create the following [asis,PTR] record in [asis,DNS]:"):h.length?s.maketext("To fix this problem, contact your system administrator and request that they create the following [asis,PTR] record at [list_and_quoted,_1]:",h):s.maketext("To fix this problem, contact your system administrator and request that they create the following [asis,PTR] record in [asis,DNS]:")),"HELO_MISMATCH"===o){var p=a.filter(function(e){return e.domain!==l}).map(function(e){return e.domain}),m=s.maketext("The system sends “[_1]”’s outgoing email from the “[_2]” [output,abbr,IP,Internet Protocol] address.",n.currentDomain.domain,c);n.badPTRMessages=[m+" "+s.maketext("The only [asis,PTR] value for this [output,abbr,IP,Internet Protocol] address must be “[_1]”. This is the name that this server sends with [output,abbr,SMTP,Simple Mail Transfer Protocol]’s “[_2]” command to send “[_3]”’s outgoing email.",l,"HELO",n.currentDomain.domain),s.maketext("[numf,_1] unexpected [asis,PTR] [numerate,_1,value exists,values exist] for this [output,abbr,IP,Internet Protocol] address:",p.length)],n.badPTRNames=p,n.ptrToFixMessage=i.isWhm()?h.length?s.maketext("To fix this problem, replace all [asis,PTR] records for “[_1]” with the following record at [list_and_quoted,_2]:",d,h):s.maketext("To fix this problem, replace all [asis,PTR] records for “[_1]” with the following record:",d):h.length?s.maketext("To fix this problem, contact your system administrator and request that they replace all [asis,PTR] records for “[_1]” with the following record at [list_and_quoted,_2]:",d,h):s.maketext("To fix this problem, contact your system administrator and request that they replace all [asis,PTR] records for “[_1]” with the following record:",d)}if("PTR_MISMATCH"===o){var f=a[0].forward_records,_=s.maketext("The system sends the domain “[_1]” in the [output,abbr,SMTP,Simple Mail Transfer Protocol] handshake for this domain’s email.",l);_+=f.length?" "+s.maketext("“[_1]” resolves to [list_and_quoted,_2], not “[_3]”.",l,f,c):" "+s.maketext("“[_1]” does not resolve to any [output,abbr,IP,Internet Protocol] addresses.",l),n.badPTRMessages=[_];var g=r.isValid(c)?"AAAA":"A";n.ptrToFixMessage=i.isWhm()?s.maketext("To fix this problem, create a [output,abbr,DNS,Domain Name System] “[_1]” record for “[_2]” whose value is “[_3]”.",g,l,c):s.maketext("To fix this problem, contact your system administrator and request that they create a [output,abbr,DNS,Domain Name System] “[_1]” record for “[_2]” whose value is “[_3]”.",g,l,c)}}},n.localDKIMExists=function(){return c.localDKIMExists(n.currentDomain)},n.ensureLocalDKIMKeyExists=function(){return c.ensureLocalDKIMKeyExists(n.currentDomain)},n.init()};u.push(h);var p=e.module(c,l);return p.controller(d,u),{"class":h,namespace:c}}),define("shared/js/email_deliverability/views/manageDomainSPF",["angular","lodash","cjt/util/locale","shared/js/email_deliverability/services/domains","shared/js/email_deliverability/services/spfParser","shared/js/email_deliverability/services/SPFRecordProcessor","shared/js/email_deliverability/directives/copyField","cjt/modules","cjt/services/cpanel/componentSettingSaverService","cjt/directives/callout","cjt/directives/multiFieldEditorItem","cjt/directives/multiFieldEditor","cjt/directives/actionButtonDirective","cjt/validator/ip-validators","cjt/validator/domain-validators"],function(e,t,i,s,r,n,o){"use strict";var a="shared.emailDeliverability.views.manageDomainSPF",c=[s.namespace,o.namespace],l="ManageDomainSPFController",d=["$scope","$log","$location","$routeParams","DomainsService","alertService","componentSettingSaverService","ADD_RESOURCE_PANEL"],u=function(s,o,a,c,d,u,h,p){var m=["additionalHosts","additionalMXServers","additionalIPv4Addresses","additionalIPv6Addresses","additionalINCLUDEItems"];return s.init=function(){var e=d.getAll();return!s.currentDomain&&e.length>1?(u.add({message:i.maketext("You did not specify a domain to manage."),type:"danger"}),void a.path("/").search("")):(1===e.length&&(s.currentDomain=e[0]),h.get(l).then(function(e){"undefined"!=typeof e&&e&&(s.showAllHelp=e.showAllHelp)}),h.register(l),s.$on("$destroy",function(){h.unregister(l)}),m.forEach(function(e){s.$watchCollection(e,s.updatePreview.bind(s))}),d.validateAllRecords([s.currentDomain]).then(function(){s.suggestedRecord=s.currentDomain.getSuggestedRecord("spf");var e=s.suggestedRecord.originalExpected||"",t=e.trim().split(/\s+/);s.missingMechanisms=t.map(n._parseSPFTerm).filter(function(e){return e.type?!0:!1}),s.workingRecord=s.suggestedRecord,s.populateFormFrom(s.workingRecord),s.updatePreview()}))},s.parseRecord=function(e){if(e&&e.value){var t=r.parse(e.value),i=t.mechanisms;i.forEach(function(e){return"all"===e.type||e.value?-1===["version","all"].indexOf(e.type)&&"+"!==e.prefix?(o.debug("Non-pass mechanism exists. Presenting warning.",e),void(s.nonPassPrefixesExist=!0)):void("mx"===e.type?s.additionalMXServers.push(e.value):"ip4"===e.type?s.additionalIPv4Addresses.push(e.value):"ip6"===e.type?s.additionalIPv6Addresses.push(e.value):"all"===e.type&&"-"===e.prefix?s.excludeAllOtherDomains=!0:"a"===e.type?s.additionalHosts.push(e.value):"include"===e.type&&s.additionalINCLUDEItems.push(e.value)):void 0})}},s.removeDuplicates=function(){m.forEach(function(e){var i=s[e].slice(0),r=t.uniq(i);s[e].splice(0,s[e].length),r.forEach(s[e].push)})},s.populateFormFrom=function(e){m.forEach(function(e){s[e].splice(0,s[e])}),s.parseRecord(e)},s.toggleExcludeAllOtherDomains=function(){s.excludeAllOtherDomains=!s.excludeAllOtherDomains,s.updatePreview()},s.updatePreview=function(){var e=["v=spf1","+mx","+a"];if(s.missingMechanisms){s.additionalHosts.forEach(function(t){e.push("+a:"+t)}),s.additionalMXServers.forEach(function(t){e.push("+mx:"+t)}),s.additionalIPv4Addresses.forEach(function(t){e.push("+ip4:"+t)}),s.additionalIPv6Addresses.forEach(function(t){e.push("+ip6:"+t)}),s.additionalINCLUDEItems.forEach(function(t){e.push("+include:"+t)});var t,i,o=s.currentDomain.getCurrentRecord("spf");o&&o.value&&(t=r.parse(o.value),i=t.mechanisms,i.forEach(function(t){-1===["version","all"].indexOf(t.type)&&"+"!==t.prefix&&e.push(t.prefix+t.type+":"+t.value)})),e.push(s.excludeAllOtherDomains?"-all":"~all");var a=e.join(" ");s.workingRecord=n.combineRecords(a,s.missingMechanisms)}},s.hasNSAuthority=function(){return s.currentDomain.hasNSAuthority},s.badConfigurationMessage=function(e){return i.maketext("“[_1]” is [output,strong,not] properly configured for this domain.",e.toUpperCase())},s.noAuthorityMessage=function(e){return d.getNoAuthorityMessage(s.currentDomain,e)},s.toggleHelp=function(){s.showAllHelp=!s.showAllHelp,s.saveToComponentSettings()},s.saveToComponentSettings=function(){h.set(l,{showAllHelp:s.showAllHelp})},s.update=function(){return d.repairDomain(s.currentDomain,["spf"],[s.workingRecord]).finally(function(){s.showConfirmDKIM=!1})},s.currentDomain=d.findDomainByName(c.domain),e.extend(s,{getCurrentRecord:s.currentDomain.getCurrentRecord.bind(s.currentDomain),resourcesPanelTemplate:p,showAllHelp:!1,currentRecord:"",workingRecord:"",excludeAllOtherDomains:!1,additionalHosts:[],additionalMXServers:[],additionalIPv4Addresses:[],additionalIPv6Addresses:[],additionalINCLUDEItems:[]}),s.init()};d.push(u);var h=e.module(a,c);return h.controller(l,d),{"class":u,namespace:a}}),define("shared/js/email_deliverability/views/manageDomainDKIM",["angular","lodash","cjt/util/locale","shared/js/email_deliverability/services/domains","shared/js/email_deliverability/directives/copyField","cjt/modules","cjt/services/cpanel/componentSettingSaverService","cjt/directives/callout","cjt/directives/multiFieldEditorItem","cjt/directives/multiFieldEditor","cjt/directives/actionButtonDirective"],function(e,t,i,s,r){"use strict";var n="shared.emailDeliverability.views.manageDomainDKIM",o=[s.namespace,r.namespace],a="ManageDomainDKIMController",c=["$scope","$location","$routeParams","DomainsService","alertService","componentSettingSaverService","ADD_RESOURCE_PANEL"],l=function(t,s,r,n,o,c,l){t.getWorkingRecords=function(){t.suggestedRecord=t.currentDomain.getSuggestedRecord("spf"),t.workingRecord=t.suggestedRecord;var e=t.currentDomain.getRecords(["dkim"]);t.currentRecord=e[0]?e[0].current:""},t.init=function(){var e=n.getAll();return!t.currentDomain&&e.length>1?(o.add({message:i.maketext("You did not specify a domain to manage."),type:"danger"}),void s.path("/").search("")):(1===e.length&&(t.currentDomain=e[0]),t.getWorkingRecords(),t.suggestedRecord||n.validateAllRecords([t.currentDomain]).then(t.getWorkingRecords),c.get(a).then(function(e){"undefined"!=typeof e&&e&&(t.showAllHelp=e.showAllHelp)}),c.register(a),void t.$on("$destroy",function(){c.unregister(a)}))},t.toggleHelp=function(){t.showAllHelp=!t.showAllHelp,t.$broadcast("showHideAllChange",t.showAllHelp)},t.saveToComponentSettings=function(){c.set(a,{showAllHelp:t.showAllHelp})},t.hasNSAuthority=function(){return t.currentDomain.hasNSAuthority},t.requestConfirmDownloadDKIMKey=function(){t.confirmDKIMDownloadRequest=!0},t._getPrivateDKIMKeyLoaded=function(e){t.dkimPrivateKey=e.pem},t.confirmRevealDKIMKey=function(){return n.fetchPrivateDKIMKey(t.currentDomain).then(t._getPrivateDKIMKeyLoaded).finally(t.cancelRevealDKIMKey)},t.cancelRevealDKIMKey=function(){t.confirmDKIMDownloadRequest=!1},e.extend(t,{currentDomain:n.findDomainByName(r.domain),resourcesPanelTemplate:l,showAllHelp:!1,currentRecord:"",workingRecord:""}),t.init()};c.push(l);var d=e.module(n,o);return d.controller(a,c),{"class":l,namespace:n}}),define("shared/js/email_deliverability/directives/recordStatus",["angular","cjt/util/locale","cjt/core"],function(e,t,i){"use strict";var s="shared/js/email_deliverability/directives/recordStatus.ptt",r=i.config.debug?i.buildFullPath(s):i.buildPath(s),n="cpanel.emailDeliverabilitty.recordStatus.directive",o=[],a=["$scope"],c=function(i){i._getStatusIconClass=function(e){return e?"fa-check text-success":"fa-exclamation-triangle text-warning"},i._getStatusDescription=function(e){return t.maketext(e?"No problems exist on this domain.":"One or more problems exist on this domain.")},i._getStatusLabel=function(e){return t.maketext(e?"Valid":"Problems Exist")},i._updateStatus=function(){if(i.domain&&i.domain.recordsLoaded){var t=i.records.some(function(e){return!i.domain.isRecordValid(e)}),s=!t;e.extend(i,{statusIconClass:i._getStatusIconClass(s),statusLabel:i._getStatusLabel(s),statusDescription:i._getStatusDescription(s),recordLoading:!1})}else i.recordLoading=!0},i.getLoadingMessage=function(){return i.domain?i.domain.reloadingIn?t.maketext("Rechecking the server records in [quant,_1,second,seconds] …",i.domain.reloadingIn):t.maketext("Loading …"):""};var s=i.$watch(function(){return i.domain?i.domain.recordsLoaded:!1},i._updateStatus);i.domain&&i._updateStatus(),i.$on("$destroy",function(){s()})},l=e.module(n,o),d=function(e){e.recordLoading=!0};return l.directive("recordStatus",function(){return{templateUrl:r,scope:{parentID:"@id",records:"=",domain:"="},restrict:"EA",replace:!1,link:d,controller:a.concat(c)}}),{"class":c,namespace:n,link:d,template:r}}),define("shared/js/email_deliverability/directives/edDomainListerViewDirective",["angular","lodash","cjt/core","cjt/util/locale","shared/js/email_deliverability/directives/recordStatus","shared/js/email_deliverability/filters/htmlSafeString","shared/js/email_deliverability/services/domains"],function(e,t,i,s,r,n,o){"use strict";var a="cpanel.emailDeliverabilitty.domainListerView.directive",c=[r.namespace,o.namespace,n.namespace],l="shared/js/email_deliverability/directives/edDomainListerViewDirective.ptt",d=i.config.debug?i.buildFullPath(l):i.buildPath(l),u=["$scope","DomainsService","ITEM_LISTER_CONSTANTS","DOMAIN_TYPE_CONSTANTS","PAGE"],h=function(e,i,r,n,o){function a(e){var t=i.getDomainZoneObject(e);return t&&t.getLockDomain()}e.DOMAIN_TYPE_CONSTANTS=n,e.EMAIL_ACCOUNTS_APP_EXISTS=o.EMAIL_ACCOUNTS_APP_EXISTS,e.webserverRoleAvailable=o.hasWebServerRole,e.recordsToCheck=i.getSupportedRecordTypes(),e._confirmingRepairDomains={},e.getDomains=function(){return e.domains},e.escapeString=t.escape,e.getDomainRowClasses=function(e){if(e.recordsLoaded){if(e.recordsValid)return!1;e._rowClasses="warning"}return e._rowClasses},e.showRecordsFilteredMessage=function(e){if(!e.recordsLoaded)return!1;if(!e.recordsValid)return!1;var t=e.getRecordTypesLoaded(),s=i.getSupportedRecordTypes();return t.length!==s.length},e.confirmRepair=function(t){e._confirmingRepairDomains[t.domain]=!0},e.cancelConfirmRepair=function(t){e._confirmingRepairDomains[t.domain]=!1},e.isConfirmingRepair=function(t){return e._confirmingRepairDomains[t.domain]},e.getDomainLockedMessage=function(e){return e.recordsLoaded&&!e.hasNSAuthority?e.nameservers.length?s.maketext("This system does not control [asis,DNS] for the “[_1]” domain. Contact the person responsible for the [list_and_quoted,_3] [numerate,_2,nameserver,nameservers] and request that they update the records.",e.domain,e.nameservers.length,e.nameservers):s.maketext("This system does not control [asis,DNS] for the “[_1]” domain, and the system did not find any authoritative nameservers for this domain. Contact your domain registrar to verify this domain’s registration.",e.domain):!e.recordsLoadingIn&&a(e)?s.maketext("You cannot modify this domain while a domain on the “[_1]” zone is updating.",e.zone):!1},e.whyCannotAutoRepairDomain=function(e){var t;if(e.recordsLoaded)if(e.hasNSAuthority){var i=a(e);i?t=s.maketext("Automatic repair is currently unavailable for this domain. You must wait until “[_1]”’s operation completes because these two domains share the same [output,acronym,DNS,Domain Name System] zone.",i):e.isRecordValid("spf")&&e.isRecordValid("dkim")&&(t=s.maketext("This domain’s [output,acronym,DKIM,Domain Keys Identified Mail] and [output,acronym,SPF,Sender Policy Framework] configurations are valid."))}else t=s.maketext("Automatic repair is not available for this domain because this system is not authoritative for this domain.");else t=s.maketext("Loading …");return t},e.actionButtonClicked=function(t,i){return e.$emit(r.TABLE_ITEM_BUTTON_EVENT,{actionType:t,item:i,interactionID:i.domain})};var c=["dkim","spf","ptr"];e.getRecordTypesWithIssues=function(e){var t=e.getRecordTypesWithIssues();return 0===t.length?!1:(t.sort(function(e,t){return e=c.indexOf(e),t=c.indexOf(t),t>e?-1:e>t?1:0}),t=t.map(function(e){return e=e.toUpperCase(),"PTR"===e?s.maketext("Reverse [asis,DNS]"):e.toUpperCase()}),s.list_and(t))},e.localDKIMExists=function(e){return i.localDKIMExists(e)},e.ensureLocalDKIMKeyExists=function(e){return i.ensureLocalDKIMKeyExists(e)}},p=e.module(a,c);p.value("PAGE",PAGE);var m=function(e,t,i,s){e.domains=[],e.headerItems=s.getHeaderItems(),e.updateView=function(t){e.domains=t},s.registerViewCallback(e.updateView.bind(e)),e.$on("$destroy",function(){s.deregisterViewCallback(e.updateView)})};return p.directive("domainListerView",function(){return{templateUrl:d,restrict:"EA",replace:!0,require:"^itemLister",link:m,controller:u.concat(h)}}),{"class":h,namespace:a,link:m,template:d}}),define("shared/js/email_deliverability/directives/tableShowingDirective",["angular","cjt/util/locale","cjt/core"],function(e,t,i){"use strict";var s="shared/js/email_deliverability/directives/tableShowingDirective.ptt",r=i.config.debug?i.buildFullPath(s):i.buildPath(s),n="shared.emailDeliverability.tableShowing.directive",o=e.module(n,[]),a=function(e){e.getShowingText=function(){return t.maketext("[_1] - [_2] of [_3]",e.start,e.limit,e.total)}};return o.directive("tableShowing",function(){return{templateUrl:r,restrict:"EA",scope:{start:"=",limit:"=",total:"="},transclude:!0,controller:["$scope",a]}}),{"class":a,namespace:n,template:r}}),define("shared/js/email_deliverability/directives/itemLister",["angular","lodash","cjt/core","shared/js/email_deliverability/directives/tableShowingDirective","ngSanitize","ngRoute","cjt/modules","cjt/directives/pageSizeButtonDirective","cjt/services/cpanel/componentSettingSaverService","cjt/directives/toggleSortDirective","cjt/directives/searchDirective","cjt/directives/pageSizeDirective","cjt/filters/startFromFilter","cjt/decorators/paginationDecorator"],function(e,t,i,s){"use strict";var r=[s.namespace,"ngRoute","ngSanitize","cjt2.filters.startFrom"],n="shared.emailDeliverability.itemLister.directive",o="domainsItemLister",a=["$routeParams","$scope","$filter","$log","$window","componentSettingSaverService","ITEM_LISTER_CONSTANTS"],c=function(i,s,r,n,a,c,l){s.viewCallbacks=[];var d={filter:r("filter"),orderBy:r("orderBy"),startFrom:r("startFrom"),limitTo:r("limitTo")};s._filter=function(e){return""!==s.filterValue?d.filter(e,{domain:s.filterValue},!1):e},s._sort=function(e){return""!==s.sort.sortDirection&&""!==s.sort.sortBy?d.orderBy(e,s.sort.sortBy,"asc"!==s.sort.sortDirection):e},s._paginate=function(e){if(s.totalItems>t.min(s.pageSizes)){var i=(s.currentPage-1)*s.pageSize,r=s.pageSize;e=d.startFrom(e,i),e=d.limitTo(e,r),s.showPager=!0,s.start=i+1,s.limit=i+e.length}else s.showPager=!1,s.start=0===e.length?0:1,s.limit=e.length;return e},s._updatedListerState=function(e){if(!s.loadingInitialState){var t={totalItems:s.totalItems,currentPage:s.currentPage,pageSize:s.pageSize,start:s.start,limit:s.limit,lastInteractedItem:e,filterValue:s.filterValue,sort:{sortDirection:s.sort.sortDirection,sortBy:s.sort.sortBy}};c.set(o,t)}},s._itemInteracted=function(e,t){t.interactionID&&s._updatedListerState(t.interactionID)},this.registerViewCallback=function(e){s.viewCallbacks.push(e),e(s.filteredItems)},this.getHeaderItems=function(){return s.headerItems},this.deregisterViewCallback=function(e){for(var t=s.viewCallbacks.length-1;t>=0;t--)s.viewCallbacks[t]===e&&s.viewCallbacks.splice(t,1)},s.fetch=function(){var t=[];return t=s._filter(s.items),s.totalItems=t.length,t=s._sort(t),t=s._paginate(t),s.filteredItems=t,s._updatedListerState(),e.forEach(s.viewCallbacks,function(e){e(s.filteredItems)}),s.$emit(l.ITEM_LISTER_UPDATED_EVENT,{meta:{filterValue:s.filterValue},items:t}),t},s.focusSearch=function(){e.element(document).find("#"+s.parentID+"_search_input").focus(),a.scrollTop=0},s.tableConfigurationClicked=function(e){s.$emit(l.TABLE_ITEM_BUTTON_EVENT,{actionType:"tableConfigurationClicked",config:e})},s.$on(l.TABLE_ITEM_BUTTON_EVENT,s._itemInteracted),e.extend(s,{maxPages:5,totalItems:s.items.length,filteredItems:[],currentPage:1,pageSize:20,pageSizes:[10,20,50],start:0,limit:20,filterValue:"",sort:{sortDirection:"asc",sortBy:s.headerItems.length?s.headerItems[0].field:""}},{filterValue:i.q}),s._savedStateLoaded=function(t){e.extend(s,t,{filterValue:i.q})};var u=c.register(o);u&&(s.loadingInitialState=!0,u.then(s._savedStateLoaded,n.error).finally(function(){s.loadingInitialState=!1,s.fetch()})),s.$on("$destroy",function(){c.unregister(o)}),s.fetch(),s.$watch("items",s.fetch)},l="shared/js/email_deliverability/directives/itemLister.ptt",d=i.config.debug?i.buildFullPath(l):i.buildPath(l),u=["$window","$log","componentSettingSaverService"],h=function(t,i){t.controlsBlock=null,t.contentBlock=null,t._attachControls=function(e){t.controlsBlock.append(e)},t._attachOthers=function(e){e.setAttribute("id",t.parentID+"_transcludePoint"),e.setAttribute("ng-if","filteredItems.length"),t.contentBlock.replaceWith(e)},t._attachTransclude=function(i){e.element(i).hasClass("lister-controls")?t._attachControls(i):t._attachOthers(i)},t._findTranscludes=function(){t.controlsBlock=i.find("#"+t.parentID+"_transcludedControls"),t.contentBlock=i.find("#"+t.parentID+"_transcludePoint");var s=i.find("div.transcluded"),r=s.children();e.forEach(r,t._attachTransclude,t),s.remove()},setTimeout(t._findTranscludes,2)},p=function(){return{templateUrl:d,restrict:"EA",scope:{parentID:"@id",items:"=",headerItems:"=",tableConfigurations:"="},transclude:!0,replace:!0,link:h,controller:a.concat(c)}},m=e.module(n,r);return m.directive("itemLister",u.concat(p)),{"class":c,namespace:n,link:h,template:d}}),define("shared/js/email_deliverability/views/listDomains",["angular","lodash","cjt/util/locale","shared/js/email_deliverability/directives/edDomainListerViewDirective","shared/js/email_deliverability/directives/tableShowingDirective","shared/js/email_deliverability/directives/itemLister","shared/js/email_deliverability/services/domains","cjt/modules"],function(e,t,i,s,r,n,o){"use strict";function a(e,t,i,s,r){function n(){return s?i+" <span class='thead-desc'>"+s+"</span>":i}var o=new c;return o.field=e,o.label=n(),o.sortable=t,o.hiddenOnMobile=r,o}var c=function(){this.field="",this.label="",this.sortable=!1},l="shared.emailDeliverability.views.listDomains",d=[r.namespace,n.namespace,s.namespace,o.namespace],u="ListDomainsController",h=["$scope","$timeout","$location","$log","$q","alertService","DomainsService","initialDomains","ITEM_LISTER_CONSTANTS","PAGE"],p=function(e,t,s,r,n,o,c,l,d,u){e.itemChangeRequested=function(t,i){switch(i.actionType){case"manage":e.manageDomain(i.item.domain);break;case"repair":e.repairDomain(i.item.domain);break;case"repairAll":e.repairAllDomainRecords(i.domain)}},e.manageDomain=function(e){c.markViewLoad(),s.path("manage").search("domain",e)},e.getSuggestedRecord=function(e,t){return e.getSuggestedRecord(t)},e.repairDomain=function(t){var i=c.findDomainByName(t);o.clear();var s=e.getDisplayedRecordTypes();s=s.filter(function(e){return"ptr"===e||i.isRecordValid(e)?!1:!0});var r=s.map(function(t){var s=e.getSuggestedRecord(i,t);return s.value});return c.repairDomain(t,s,r)},e.getDisplayedRecordTypes=function(){return c.getSupportedRecordTypes()},e._fetchTableData=function(t){var i=e.getDisplayedRecordTypes();return c.validateAllRecords(t,i)},e._beginDelayedFetch=function(){e.currentTimeout&&(t.cancel(e.currentTimeout),e.currentTimeout=null),e.currentTimeout=t(e._fetchTableData,500,!0,e.pageDomains)},e._itemListerUpdated=function(t,i){e.itemListerMeta=i.meta,e.currentSearchFilterValue=e.itemListerMeta.filterValue,e.pageDomains=i.items,e._beginDelayedFetch()},e._buildTableHeaders=function(){var e=[];return e.push(a("domain",!0,i.maketext("Domain"),!1,!1)),e.push(a("status",!1,i.maketext("Email Deliverability Status"),!1,!0)),e.push(a("actions",!1,"",!1)),e},e.getFilteredDomains=function(){return e.filteredDomains},e._readyToDisplay=function(){e.$on(d.TABLE_ITEM_BUTTON_EVENT,e.itemChangeRequested),e.$on(d.ITEM_LISTER_UPDATED_EVENT,e._itemListerUpdated)},e.init=function(){1===l.length&&u.CAN_SKIP_LISTER?s.path("/manage").search("domain",l[0].domain):(e.domains=l,e.filteredDomains=l,e.tableHeaderItems=e._buildTableHeaders(),e._readyToDisplay())},e.init()};h.push(p);var m=e.module(l,d);return m.controller(u,h),{"class":p,namespace:l}}),define("app/index",["angular","lodash","cjt/core","app/controllers/ROUTES","app/controllers/route","shared/js/email_deliverability/services/domains","shared/js/email_deliverability/filters/htmlSafeString","app/decorators/paginationDecorator","cjt/io/uapi-request","ngRoute","ngAnimate","angular-chosen","cjt/modules","cjt/io/uapi","cjt/directives/breadcrumbs","cjt/services/alertService","cjt/directives/loadingPanel","shared/js/email_deliverability/views/manageDomain","shared/js/email_deliverability/views/manageDomainSPF","shared/js/email_deliverability/views/manageDomainDKIM","shared/js/email_deliverability/views/listDomains"],function(e,t,i,s,r,n,o,a,c){"use strict";return function(){var t="cpanel.emailDeliverability",i=["ngRoute","ngAnimate","cjt2.cpanel","cjt2.directives.loadingPanel","cjt2.services.alert",n.namespace,o.namespace,r.namespace,a.namespace],l=["cjt/bootstrap"];s.forEach(function(e){i.push("shared.emailDeliverability.views."+e.controllerAs),l.push("shared/js/email_deliverability/views/"+e.controllerAs)}),e.module(t,i);var d=require(l,function(i){var r=e.module(t);r.value("PAGE",PAGE),r.value("ADD_RESOURCE_PANEL","views/additionalResourcesPanel.ptt"),r.factory("APIInitializer",function(){var e=function(){function e(e,t){var i=new c.Class;return i.initialize(e,t)}function t(e,t,i){return JSON.stringify([e,t,i])}function i(e){return e}this.normalizeBatchResults=i.bind(this),this.init=e.bind(this),this.buildBatchCommandItem=t.bind(this)};return new e}),r.value("ITEM_LISTER_CONSTANTS",{TABLE_ITEM_BUTTON_EVENT:"TableItemActionButtonEmitted",ITEM_LISTER_UPDATED_EVENT:"ItemListerUpdatedEvent"}),r.value("RECORD_STATUS_CONSTANTS",{VALID:"validRecordStatus",OUT_OF_SYNC:"outOfSyncRecordStatus",MISSING:"missingRecordStatus",TOO_MANY:"tooManyRecordStatus",LOADING:null}),r.config(["$routeProvider","$animateProvider",function(e,t){t.classNameFilter(/^((?!no-animate).)*$/),s.forEach(function(t){e.when(t.route,t)}),e.otherwise({redirectTo:"/"})}]),i("#content",t)});return d}});